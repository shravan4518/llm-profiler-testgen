{
  "job_id": "4d8529a8",
  "user_prompt": "Profiler DHCP configuration",
  "model": "gpt-4.1-nano",
  "parameters": {
    "output_formats": [
      "json",
      "markdown",
      "excel"
    ],
    "use_iteration": true
  },
  "target_config": {
    "url": "https://npre-miiqa2mp-eastus2.openai.azure.com/",
    "username": "shravan",
    "password": "saishravan",
    "browser": "chromium",
    "environment": "dev"
  },
  "status": "completed",
  "created_at": "2026-01-05T22:00:25.028390",
  "updated_at": "2026-01-05T22:09:03.000062",
  "test_cases": ": COMPREHENSIVE TEST CASES\n\n#### TC_001\n**Test Title:** Verify DHCPv4 fingerprinting via DHCP Helper (Relay) on internal port  \n**Category:** positive  \n**Priority:** Critical  \n**Description:** Validate that Profiler correctly captures and fingerprints DHCPv4 traffic received via DHCP relay (IP helper) to the PPS internal interface and creates a device record.  \n**Prerequisites:**  \n- PPS/Profiler 9.1R10 or later installed and licensed.  \n- Profiler enabled and basic configuration completed.  \n- DHCP fingerprints package version ≥ 45 uploaded and active.  \n- Profiler DHCP sniffing mode set to “DHCP Helper for internal ports.”  \n- Access switch configured with IP helper-address pointing to PPS internal IP for target VLAN.  \n- Test endpoint (Windows 10 laptop) configured for DHCP in VLAN 20.  \n**Test Data:**  \n- PPS internal IP: 10.10.10.10  \n- Switch VLAN 20 IP: 10.10.20.1  \n- DHCP server IP: 10.10.30.10  \n- Test endpoint MAC: AA:BB:CC:DD:EE:01  \n**Test Steps:**  \n1. Log in to PPS admin UI as admin.  \n2. Navigate to Profiler Configuration > Settings > Basic Configuration.  \n3. Confirm DHCP Sniffing mode is set to “DHCP Helper for internal ports” and applied.  \n4. On the access switch, verify `ip helper-address 10.10.10.10` is configured on VLAN 20 interface.  \n5. Power off the test endpoint if it is on.  \n6. Power on the test endpoint and let it boot to request an IP via DHCP.  \n7. In PPS, navigate to Profiler > Discovered Devices (or equivalent).  \n8. Search for the endpoint MAC `AA:BB:CC:DD:EE:01` or obtained IP.  \n9. Open the device details page.  \n**Expected Results:**  \n- DHCP DISCOVER/OFFER/REQUEST/ACK exchange is seen in Profiler logs or packet capture.  \n- A new device record is created with MAC `AA:BB:CC:DD:EE:01`.  \n- Device classification shows a Windows desktop/laptop based on DHCP fingerprint.  \n- Device IP, VLAN, and first-seen timestamp are correctly populated.  \n**Postconditions:**  \n- Device entry for the test endpoint remains in Profiler database with correct classification and DHCPv4 metadata.\n\n---\n\n#### TC_002\n**Test Title:** Verify DHCPv4 fingerprinting via SPAN/RSPAN on external port  \n**Category:** positive  \n**Priority:** High  \n**Description:** Ensure Profiler correctly captures DHCPv4 packets mirrored to an external port via SPAN/RSPAN and fingerprints the endpoint.  \n**Prerequisites:**  \n- PPS appliance with one port configured as “external” sniffing interface connected to SPAN destination.  \n- Switch SPAN session configured to mirror DHCP traffic (VLAN 30) to PPS external port.  \n- Profiler General Settings: DHCP Sniffing mode set to “RSPAN for external ports.”  \n- DHCP fingerprints database version ≥ 45.  \n**Test Data:**  \n- PPS external sniffing port: ge-0/0/1  \n- Mirrored VLAN: 30  \n- Test endpoint MAC: AA:BB:CC:DD:EE:02 running iOS device (e.g., iPhone).  \n**Test Steps:**  \n1. In PPS UI, navigate to Profiler Configuration > Settings > Basic Configuration.  \n2. Set DHCP Sniffing mode to “RSPAN for external ports” and save.  \n3. On the core/distribution switch, confirm SPAN/RSPAN is configured to mirror VLAN 30 DHCP traffic to PPS external port.  \n4. Connect iOS device to Wi-Fi mapped to VLAN 30 with DHCP enabled.  \n5. Wait for the device to obtain an IP address.  \n6. In PPS, go to Profiler > Discovered Devices.  \n7. Search for MAC `AA:BB:CC:DD:EE:02`.  \n8. Open device details and review DHCP fingerprint information.  \n**Expected Results:**  \n- Profiler receives DHCPv4 traffic via external port.  \n- A device record is created for MAC `AA:BB:CC:DD:EE:02`.  \n- Device is classified as iOS or similar mobile OS based on DHCP options.  \n- No duplicate devices created for the same MAC.  \n**Postconditions:**  \n- Device record remains in Profiler with DHCPv4 metadata sourced from SPAN.\n\n---\n\n#### TC_003\n**Test Title:** Enable DHCPv6 packet capturing in basic configuration  \n**Category:** positive  \n**Priority:** High  \n**Description:** Validate that enabling “DHCPv6 packet capturing” in Basic Configuration activates the DHCPv6Collector and Profiler starts capturing DHCPv6 traffic.  \n**Prerequisites:**  \n- PPS/Profiler version with Phase 3 IPv6 support enabled.  \n- Dual-stack network with DHCPv6 server and IPv6-enabled endpoint.  \n- Administrator access to PPS UI.  \n**Test Data:**  \n- PPS internal IPv6: 2001:db8:10::10  \n- Endpoint MAC: AA:BB:CC:DD:EE:03 (Windows 10 dual stack).  \n**Test Steps:**  \n1. Log in to PPS as admin.  \n2. Navigate to Profiler Configuration > Settings > Basic Configuration.  \n3. Check the option “Enable DHCPv6 packet capturing”.  \n4. If available, also enable “DHCPv6 sniffing over external port” and save configuration.  \n5. Note the time of configuration change.  \n6. Wait 15 minutes to allow configuration to take effect (per documentation).  \n7. Reboot the dual-stack endpoint so that it requests IPv6 via DHCPv6.  \n8. In PPS, access Profiler > Discovered Devices and filter for the endpoint MAC `AA:BB:CC:DD:EE:03`.  \n9. Open device details and verify IPv6 DHCP information.  \n**Expected Results:**  \n- DHCPv6Collector process is started/enabled (visible in logs or status page).  \n- Profiler records the DHCPv6 transaction for the endpoint.  \n- Device record shows IPv6 address and DHCPv6 options.  \n- Device classification includes IPv6 context (still consistent with OS fingerprint).  \n**Postconditions:**  \n- DHCPv6 packet capturing remains enabled for subsequent IPv6 endpoints.\n\n---\n\n#### TC_004\n**Test Title:** Verify Profiler operation when configuration changes applied (15-minute delay)  \n**Category:** positive  \n**Priority:** Medium  \n**Description:** Confirm that Profiler honors the documented 15-minute delay before new configuration takes effect, without service disruption.  \n**Prerequisites:**  \n- Profiler running and actively capturing DHCPv4.  \n- At least one known device already discovered.  \n**Test Data:**  \n- Change: Add subnet 10.10.50.0/24 to Profiler scan/DHCP scope configuration.  \n- Test endpoint MAC: AA:BB:CC:DD:EE:04 in new subnet.  \n**Test Steps:**  \n1. In PPS, go to Profiler Configuration > Subnets (or equivalent) and add subnet 10.10.50.0/24 to configurations where required for DHCP or scans.  \n2. Save changes at time T0 (record exact time).  \n3. Immediately connect endpoint with MAC `AA:BB:CC:DD:EE:04` to subnet 10.10.50.0/24 and trigger DHCP.  \n4. Within first 5 minutes after T0, check Profiler > Discovered Devices for the new MAC.  \n5. At T0 + 16 minutes, reboot the endpoint to trigger DHCP again.  \n6. Check Discovered Devices for MAC `AA:BB:CC:DD:EE:04`.  \n**Expected Results:**  \n- Within first 5 minutes, Profiler may not yet apply new subnet configuration; device may not be discovered or scanned as per new rules.  \n- After ~15 minutes (step 5), Profiler applies new configuration.  \n- Device in subnet 10.10.50.0/24 is now captured and shown in Discovered Devices with correct DHCP info.  \n- Existing profiler operations for other subnets continue uninterrupted during the waiting period.  \n**Postconditions:**  \n- Subnet 10.10.50.0/24 remains configured and functional for newly connecting devices.\n\n---\n\n#### TC_005\n**Test Title:** Validate Profiler handles both broadcast and relayed DHCPv4 requests  \n**Category:** positive  \n**Priority:** High  \n**Description:** Ensure Profiler captures local broadcast DHCPv4 and DHCPv4 received via relay and processes both correctly.  \n**Prerequisites:**  \n- PPS internal interface connected to VLAN 100 with direct broadcast DHCP from endpoints.  \n- Another VLAN 200 using DHCP relay (IP helper) to PPS internal IP.  \n- DHCP sniffing mode: “DHCP Helper for internal ports.”  \n**Test Data:**  \n- Broadcast endpoint MAC: AA:BB:CC:DD:EE:05 (VLAN 100).  \n- Relayed endpoint MAC: AA:BB:CC:DD:EE:06 (VLAN 200).  \n**Test Steps:**  \n1. Connect endpoint MAC `AA:BB:CC:DD:EE:05` directly to VLAN 100 where PPS is in the same broadcast domain.  \n2. Trigger DHCP (reboot or `ipconfig /renew`).  \n3. In Profiler UI, verify discovery of device with MAC `AA:BB:CC:DD:EE:05`.  \n4. Connect endpoint MAC `AA:BB:CC:DD:EE:06` to VLAN 200, which uses IP helper to forward DHCP to PPS.  \n5. Trigger DHCP on second endpoint.  \n6. Verify in Profiler > Discovered Devices that both MAC addresses are discovered and classified.  \n**Expected Results:**  \n- Profiler captures and processes DHCPv4 broadcast from VLAN 100.  \n- Profiler captures and processes DHCPv4 relayed packets from VLAN 200.  \n- Both endpoints have distinct entries with correct VLAN/IP information and OS classification.  \n**Postconditions:**  \n- Two device records exist, each reflecting the appropriate capture method (broadcast vs relay, as seen in logs).\n\n---\n\n#### TC_006\n**Test Title:** Behavior when DHCPv4 relay is misconfigured (no packets reach PPS)  \n**Category:** negative  \n**Priority:** Critical  \n**Description:** Verify that when DHCP relay configuration is incorrect, Profiler does not receive DHCP packets and appropriate troubleshooting indicators/logs are available.  \n**Prerequisites:**  \n- PPS configured for DHCP Helper mode.  \n- VLAN 210 endpoint using DHCP relay, but IP helper configured to wrong IP (not PPS).  \n**Test Data:**  \n- Misconfigured helper-address: 10.10.99.99 (non-existent or non-PPS IP).  \n- Endpoint MAC: AA:BB:CC:DD:EE:07.  \n**Test Steps:**  \n1. On switch, intentionally configure `ip helper-address 10.10.99.99` on VLAN 210.  \n2. Connect endpoint MAC `AA:BB:CC:DD:EE:07` to VLAN 210.  \n3. Trigger DHCP on the endpoint and confirm it fails to receive an IP address.  \n4. In PPS, check Profiler > Discovered Devices for MAC `AA:BB:CC:DD:EE:07`.  \n5. Review Profiler logs (system/diagnostics) for absence of DHCP packets from VLAN 210 and any warnings.  \n**Expected Results:**  \n- Endpoint fails to obtain IP due to incorrect relay configuration.  \n- Profiler does not create any device record for MAC `AA:BB:CC:DD:EE:07`.  \n- Logs provide evidence that no DHCP packets were received from VLAN 210, enabling admin to suspect DHCP relay misconfiguration.  \n**Postconditions:**  \n- No stale or partial device entries created for the misconfigured subnet.\n\n---\n\n#### TC_007\n**Test Title:** Invalid DHCPv4 packet structure handling  \n**Category:** negative  \n**Priority:** High  \n**Description:** Confirm that Profiler safely handles malformed DHCPv4 packets without crashing or misclassifying devices.  \n**Prerequisites:**  \n- PPS in DHCP Helper sniffing mode.  \n- Ability to inject crafted DHCP packets (e.g., using Scapy) on a test VLAN.  \n**Test Data:**  \n- Malformed DHCP packet: incorrect length, invalid option format (e.g., truncated Option 55).  \n- Source MAC: AA:BB:CC:DD:EE:08 (test generator).  \n**Test Steps:**  \n1. On a test machine, craft malformed DHCP DISCOVER packets with:  \n   - missing required fields or  \n   - corrupted options length.  \n2. Send a burst of 50 malformed DHCP packets to broadcast address on VLAN connected to PPS.  \n3. Monitor PPS Profiler logs for parsing errors.  \n4. In Profiler UI, search for MAC `AA:BB:CC:DD:EE:08`.  \n**Expected Results:**  \n- Profiler logs indicate parsing errors or discarded malformed packets.  \n- No device record is created based solely on malformed DHCP packets.  \n- Profiler service remains stable with no crash or restart.  \n**Postconditions:**  \n- Profiler continues normal operation; malformed packets do not pollute the database.\n\n---\n\n#### TC_008\n**Test Title:** DHCPv6 capturing disabled – IPv6 endpoint not profiled via DHCPv6  \n**Category:** negative  \n**Priority:** Medium  \n**Description:** Validate that when DHCPv6 packet capturing is disabled, Profiler does not process DHCPv6 traffic and does not create DHCPv6-based fingerprints.  \n**Prerequisites:**  \n- IPv6-enabled network with DHCPv6 server.  \n- DHCPv6 capturing currently enabled and functioning (baseline).  \n**Test Data:**  \n- Endpoint MAC: AA:BB:CC:DD:EE:09.  \n**Test Steps:**  \n1. In PPS, go to Profiler Configuration > Settings > Basic Configuration.  \n2. Uncheck “Enable DHCPv6 packet capturing” and save.  \n3. Wait for 15 minutes for configuration to take effect.  \n4. After 15 minutes, connect endpoint MAC `AA:BB:CC:DD:EE:09` to IPv6 network and trigger DHCPv6 (release/renew or reboot).  \n5. In Profiler UI, search for MAC `AA:BB:CC:DD:EE:09`.  \n6. Check if any DHCPv6 data or IPv6 address is associated with the device.  \n**Expected Results:**  \n- Profiler does not start or use DHCPv6Collector.  \n- No new device is discovered via DHCPv6; if device exists due to other methods (SNMP/HTTP), it lacks DHCPv6 data.  \n- No DHCPv6 logs recorded for this endpoint.  \n**Postconditions:**  \n- DHCPv6 packet capturing remains disabled until explicitly re-enabled.\n\n---\n\n#### TC_009\n**Test Title:** Boundary test – minimum supported DHCP fingerprints database version (45)  \n**Category:** boundary  \n**Priority:** High  \n**Description:** Verify that Profiler accepts device fingerprints package version 45 (minimum supported) and uses it for DHCP-based profiling.  \n**Prerequisites:**  \n- Access to support portal with fingerprints packages versions 44, 45, 46.  \n- Profiler functional and licensed.  \n**Test Data:**  \n- Fingerprints package files:  \n  - device_fingerprints_v44.pkg  \n  - device_fingerprints_v45.pkg  \n  - device_fingerprints_v46.pkg  \n- Endpoint MAC: AA:BB:CC:DD:EE:0A (Android device).  \n**Test Steps:**  \n1. Attempt to upload fingerprints package v44 via Profiler Configuration > Device Fingerprints.  \n2. Capture any error/validation messages for v44.  \n3. Upload fingerprints package v45 and apply.  \n4. Verify current fingerprints version shown is 45.  \n5. Connect Android endpoint MAC `AA:BB:CC:DD:EE:0A` and trigger DHCP.  \n6. Check Profiler classification results for that device.  \n7. Optionally upgrade to v46 and verify that upgrade works too.  \n**Expected Results:**  \n- v44 package is rejected or flagged as unsupported with a clear error referencing minimum version 45.  \n- v45 package is accepted and becomes active.  \n- Android device is profiled correctly based on DHCP fingerprint using v45.  \n- System log records the fingerprint database version change.  \n**Postconditions:**  \n- Profiler runs with fingerprints database version ≥ 45 (ideally 45 or 46 after test).\n\n---\n\n#### TC_010\n**Test Title:** Boundary – maximum DHCP fingerprint options length handling  \n**Category:** boundary  \n**Priority:** Medium  \n**Description:** Ensure Profiler properly handles DHCP Option 55 (Parameter Request List) at maximum reasonable length and does not overflow or truncate incorrectly.  \n**Prerequisites:**  \n- Test tool to generate DHCP DISCOVER packets with large Option 55 list.  \n- Profiler in DHCP Helper sniffing mode.  \n**Test Data:**  \n- DHCP DISCOVER with Option 55 including 25–30 requested options.  \n- Source MAC: AA:BB:CC:DD:EE:0B.  \n**Test Steps:**  \n1. Craft DHCP DISCOVER packets for MAC `AA:BB:CC:DD:EE:0B` with maximum-length Option 55 (including as many valid option codes as allowed by RFC and device limits).  \n2. Send several such packets to the network where PPS captures DHCP.  \n3. Observe Profiler logs for parsing of Option 55.  \n4. In Profiler UI, check the device details for MAC `AA:BB:CC:DD:EE:0B`.  \n**Expected Results:**  \n- Profiler successfully parses the long Option 55 without errors.  \n- All recognized options contribute to fingerprinting and classification.  \n- No buffer overflow or abnormal memory/resource usage.  \n**Postconditions:**  \n- Device record persists with full fingerprint details as supported.\n\n---\n\n#### TC_011\n**Test Title:** Boundary – Profiler behavior at MAC authentication limit (500 MAC auths)  \n**Category:** boundary  \n**Priority:** High  \n**Description:** Validate Profiler integration with PPS MAC auth when approaching and exceeding the known limit of 500 MAC auths on PPS, using wildcard MAC `*:*:*:*:*:*` strategy.  \n**Prerequisites:**  \n- PPS configured with local MAC auth server.  \n- MAC auth configuration set with MAC pattern `*:*:*:*:*:*` pointing to Profiler-based role mapping.  \n- Ability to simulate 500+ unique MAC addresses authenticating.  \n**Test Data:**  \n- 510 unique MACs: AA:BB:CC:DD:EE:10 through AA:BB:CC:DD:EE:FF and beyond.  \n**Test Steps:**  \n1. Using test tools, simulate 500 unique MAC-based authentications to PPS (e.g., using MAB on switches).  \n2. Ensure each MAC triggers Profiler lookup and role mapping rule.  \n3. Verify Profiler continues to classify devices and PPS grants access based on Profiler attributes.  \n4. Attempt additional 10 MAC authentications (beyond 500).  \n5. Monitor PPS and Profiler logs for any errors related to MAC auth limits or cache capacity.  \n**Expected Results:**  \n- Up to 500 MAC auths handled correctly; Profiler classification and role mapping function as intended.  \n- When exceeding 500, behavior follows PPS design (e.g., older entries purged, or MAC auth offloaded to external LDAP if configured).  \n- Profiler itself does not fail or misclassify; it processes DHCP for all.  \n**Postconditions:**  \n- System returns to normal after test; consider clearing test MAC entries if necessary.\n\n---\n\n#### TC_012\n**Test Title:** Integration – Switch configuration for DHCP Helper and CDP/LLDP does not break DHCP fingerprinting  \n**Category:** integration  \n**Priority:** Medium  \n**Description:** Verify that enabling additional switch features (CDP/LLDP and SNMP for Profiler) does not interfere with DHCP packet forwarding and fingerprinting.  \n**Prerequisites:**  \n- Switch configured with:  \n  - IP helper to PPS,  \n  - CDP and LLDP enabled,  \n  - SNMP settings pointing to PPS as Network Infrastructure Device.  \n- Profiler SNMP collector enabled.  \n**Test Data:**  \n- Endpoint MAC: AA:BB:CC:DD:EE:11.  \n**Test Steps:**  \n1. Configure switch according to documentation:  \n   - IP helper for DHCP,  \n   - CDP/LLDP enabled on access ports,  \n   - SNMP community or user configured for PPS.  \n2. In PPS, configure Network Infrastructure Device entry for the switch (SNMP).  \n3. Connect endpoint MAC `AA:BB:CC:DD:EE:11` to switch access port.  \n4. Trigger DHCP and allow device to be discovered.  \n5. In Profiler, view the device details for MAC `AA:BB:CC:DD:EE:11`.  \n6. Confirm that DHCP-based fingerprint data coexists with SNMP/CDP/LLDP-based data.  \n**Expected Results:**  \n- DHCP fingerprinting continues to work without packet loss.  \n- Additional device attributes (switch port, CDP/LLDP info) appear in device record.  \n- No duplicate or conflicting device records.  \n**Postconditions:**  \n- Integrated profiling with DHCP+SNMP/CDP/LLDP remains enabled.\n\n---\n\n#### TC_013\n**Test Title:** Integration – Forward and sync endpoint data to remote Profiler/PPS  \n**Category:** integration  \n**Priority:** Medium  \n**Description:** Validate that DHCP-based profiling results from a local Profiler are forwarded/synchronized correctly to a remote Profiler/PPS instance.  \n**Prerequisites:**  \n- Local PPS with Profiler enabled and DHCP sniffing configured.  \n- Remote PPS/PCS/profiler server configured and reachable over network.  \n- Forward and Sync Endpoint Data configuration between local and remote systems.  \n**Test Data:**  \n- Local PPS hostname: pps-local.corp.example.com  \n- Remote PPS hostname: pps-remote.corp.example.com  \n- Endpoint MAC: AA:BB:CC:DD:EE:12.  \n**Test Steps:**  \n1. On local PPS, ensure Profiler is capturing DHCP for local VLANs.  \n2. Configure Profiler Configuration > Forward and Sync Endpoint Data to send endpoint information to the remote PPS.  \n3. On remote PPS, configure to accept and store endpoint data from local PPS.  \n4. Connect endpoint MAC `AA:BB:CC:DD:EE:12` to a VLAN monitored by local Profiler and trigger DHCP.  \n5. Confirm that local Profiler discovers and classifies the device.  \n6. On remote PPS, navigate to the equivalent endpoint/device listing.  \n7. Search for MAC `AA:BB:CC:DD:EE:12`.  \n**Expected Results:**  \n- Local Profiler records DHCP details and device classification.  \n- Endpoint record for MAC `AA:BB:CC:DD:EE:12` is visible on remote PPS with synchronized attributes.  \n- No significant delay beyond expected sync interval.  \n**Postconditions:**  \n- Forward & sync remains active, and any new DHCP-based endpoints are propagated to remote PPS.\n\n---\n\n#### TC_014\n**Test Title:** Security – Access control to Profiler DHCP configuration pages  \n**Category:** security  \n**Priority:** Critical  \n**Description:** Ensure that only authorized admin users can access and modify Profiler DHCP configuration (sniffing mode, DHCPv6 capturing, device fingerprints).  \n**Prerequisites:**  \n- Two PPS admin accounts:  \n  - `pps-admin` with full admin role.  \n  - `pps-readonly` with read-only or restricted role.  \n**Test Data:**  \n- Usernames/passwords:  \n  - pps-admin / S3cureAdm!n  \n  - pps-readonly / Read0nly!  \n**Test Steps:**  \n1. Log in as `pps-admin`.  \n2. Navigate to Profiler Configuration > Settings > Basic Configuration.  \n3. Attempt to modify DHCP Sniffing mode and toggle DHCPv6 capturing; save changes.  \n4. Log out and log in as `pps-readonly`.  \n5. Attempt to access Profiler Configuration > Settings > Basic Configuration.  \n6. If access is allowed for read, attempt to change DHCP settings and save.  \n7. Attempt to upload a new fingerprints package as `pps-readonly`.  \n**Expected Results:**  \n- `pps-admin` can view and modify DHCP configuration successfully.  \n- `pps-readonly` either:  \n  - is denied access to the configuration pages, or  \n  - can only view settings but cannot save changes or upload packages (save buttons disabled or result in “permission denied” message).  \n- Any unauthorized attempt is logged with username/time.  \n**Postconditions:**  \n- Configuration remains as last valid save by authorized user; no changes from `pps-readonly`.\n\n---\n\n#### TC_015\n**Test Title:** Security – Handling of malicious DHCP options (code injection patterns)  \n**Category:** security  \n**Priority:** High  \n**Description:** Confirm that Profiler correctly sanitizes or safely stores DHCP option values that contain potentially malicious content (e.g., SQL/XSS payloads in hostnames or vendor class identifiers).  \n**Prerequisites:**  \n- Test tool to send custom DHCP options.  \n- Profiler operational and logging enabled.  \n**Test Data:**  \n- DHCP Option 12 (Host Name): `<script>alert('xss')</script>`  \n- DHCP Option 60 (Vendor Class): `test'); DROP TABLE devices;--`  \n- Source MAC: AA:BB:CC:DD:EE:13.  \n**Test Steps:**  \n1. Craft DHCP DISCOVER and REQUEST packets from MAC `AA:BB:CC:DD:EE:13` with:  \n   - Hostname set to `<script>alert('xss')</script>`  \n   - Vendor Class set to `test'); DROP TABLE devices;--`  \n2. Send packets to network so PPS captures them.  \n3. In Profiler UI, locate device record for MAC `AA:BB:CC:DD:EE:13`.  \n4. Inspect how hostname and vendor class are displayed in the UI.  \n5. Monitor server logs and database (if accessible in test environment) for any errors or SQL exceptions.  \n**Expected Results:**  \n- UI renders the hostname and vendor class as plain text; script tags are escaped, and no JavaScript is executed.  \n- No SQL errors or evidence of injection attacks.  \n- Device record is created normally, with special characters safely stored.  \n**Postconditions:**  \n- No security compromise; logs may reflect detection/normalization of special characters.\n\n---\n\n#### TC_016\n**Test Title:** Performance – High volume DHCPv4 requests (burst load)  \n**Category:** performance  \n**Priority:** High  \n**Description:** Assess Profiler’s ability to handle a large burst of DHCPv4 requests without dropping packets or significantly degrading classification performance.  \n**Prerequisites:**  \n- Test environment capable of generating high DHCP load (e.g., DHCP storm generator).  \n- Profiler and PPS sized according to deployment guidance.  \n**Test Data:**  \n- 2000 synthetic endpoints (unique MACs) sending DHCP DISCOVER/REQUEST’s over 5 minutes.  \n**Test Steps:**  \n1. Prepare a DHCP traffic generator configured to simulate 2000 unique MACs over VLAN captured by PPS.  \n2. Start Profiler log capture or monitoring tools to measure CPU/memory and packet processing.  \n3. Run the load test for 5 minutes, generating DHCP traffic.  \n4. After test, in Profiler UI, count number of newly discovered devices (approximate 2000).  \n5. Measure time from DHCP request to device visibility in UI for a sample set of endpoints.  \n**Expected Results:**  \n- Profiler processes most or all DHCP packets without crashing.  \n- Number of discovered devices is close to the 2000 simulated (within acceptable loss threshold, e.g., > 95%).  \n- CPU and memory usage increase but remain within safe limits (per product sizing guidelines).  \n- Average classification delay remains acceptable (e.g., < 60–120 seconds).  \n**Postconditions:**  \n- Profiler returns to normal resource usage after the burst; all device records persist.\n\n---\n\n#### TC_017\n**Test Title:** Performance – Sustained dual-stack (DHCPv4 + DHCPv6) traffic  \n**Category:** performance  \n**Priority:** Medium  \n**Description:** Evaluate Profiler’s performance when simultaneously handling sustained DHCPv4 and DHCPv6 traffic in a dual-stack network.  \n**Prerequisites:**  \n- DHCPv4 and DHCPv6 capturing enabled.  \n- Dual-stack network with load generation tools for both protocols.  \n**Test Data:**  \n- 500 dual-stack endpoints (unique MACs) periodically renewing DHCP leases for 1 hour.  \n**Test Steps:**  \n1. Configure test tools or VMs to simulate 500 dual-stack endpoints sending DHCPv4 and DHCPv6 renewals at regular intervals (e.g., every 5–10 minutes).  \n2. Ensure PPS is capturing both DHCPv4 and DHCPv6.  \n3. Monitor profiler CPU, memory, and logs during the 1-hour test.  \n4. After the run, verify a random sample of 20 endpoints in Profiler show both IPv4 and IPv6 addresses and correct classification.  \n**Expected Results:**  \n- Profiler sustains the load without crashes or significant backlog in processing.  \n- Both DHCPv4 and DHCPv6 data are correctly reflected for endpoints.  \n- No severe increase in processing delays over time (no memory leak or degradation).  \n**Postconditions:**  \n- System remains stable and usable after the 1-hour test; device records are intact.\n\n---\n\n#### TC_018\n**Test Title:** Negative – DHCP sniffing mode misconfigured (RSPAN selected but only IP helper configured)  \n**Category:** negative  \n**Priority:** Medium  \n**Description:** Confirm that mismatched configuration between switch (IP helper) and Profiler (RSPAN mode) results in lack of DHCP profiling and clearly diagnosable symptoms.  \n**Prerequisites:**  \n- Switch configured with IP helper to PPS internal IP.  \n- PPS Profiler DHCP sniffing set to “RSPAN for external ports” only.  \n**Test Data:**  \n- Endpoint MAC: AA:BB:CC:DD:EE:14.  \n**Test Steps:**  \n1. In PPS, set DHCP Sniffing mode to “RSPAN for external ports” and disable DHCP Helper mode (if options are exclusive).  \n2. On switch, keep IP helper configuration; do NOT configure SPAN/RSPAN.  \n3. Connect endpoint MAC `AA:BB:CC:DD:EE:14` and trigger DHCP.  \n4. Confirm endpoint receives IP address (DHCP still works at network/switch level).  \n5. In Profiler UI, search for MAC `AA:BB:CC:DD:EE:14`.  \n6. Review logs for any messages indicating no DHCP seen on external port.  \n**Expected Results:**  \n- Endpoint obtains an IP address normally via DHCP.  \n- Profiler does not see DHCP packets because it is listening only on external RSPAN port.  \n- No device record is created for MAC `AA:BB:CC:DD:EE:14`.  \n- Admin can diagnose misconfiguration from lack of packets and configuration screens/log hints.  \n**Postconditions:**  \n- No invalid device entries created; configuration remains misaligned until corrected.\n\n---\n\n#### TC_019\n**Test Title:** Integration – WLC forwarding HTTP User Agent and DHCP fingerprinting together  \n**Category:** integration  \n**Priority:** Medium  \n**Description:** Ensure DHCP fingerprinting works alongside WLC configuration that forwards HTTP User Agent to PPS, resulting in more precise classification.  \n**Prerequisites:**  \n- Wireless LAN Controller configured to forward HTTP User Agent to PPS IP.  \n- PPS Profiler DHCP capture enabled.  \n**Test Data:**  \n- Endpoint MAC: AA:BB:CC:DD:EE:15 using mobile browser (Android 5.1).  \n**Test Steps:**  \n1. Verify WLC configuration for “Forward HTTP User Agent to IPs” includes PPS IP.  \n2. Connect Android phone to Wi-Fi SSID controlled by WLC with DHCP enabled.  \n3. Trigger DHCP by toggling Wi-Fi off/on.  \n4. On the device, open a web browser and visit multiple HTTP/HTTPS sites to generate User-Agent traffic.  \n5. In Profiler UI, locate device record for MAC `AA:BB:CC:DD:EE:15`.  \n6. Review classification details and verify HTTP User Agent data is combined with DHCP fingerprint.  \n**Expected Results:**  \n- Device is initially classified via DHCP fingerprint (e.g., Generic Android).  \n- After HTTP UA data is received, classification is refined to specific Android version/device if supported.  \n- No conflict between HTTP and DHCP-based profiling; final classification is consistent and precise.  \n**Postconditions:**  \n- Device record persists with combined DHCP and HTTP UA attributes.\n\n---\n\n#### TC_020\n**Test Title:** Negative – Attempt to disable Profiler while DHCP configuration is active  \n**Category:** negative  \n**Priority:** Low  \n**Description:** Validate system behavior when an admin attempts to disable Profiler or remove configuration while DHCP sniffing is active.  \n**Prerequisites:**  \n- Profiler fully configured and actively capturing DHCP.  \n**Test Data:**  \n- Admin user: pps-admin / S3cureAdm!n.  \n**Test Steps:**  \n1. Log in as `pps-admin`.  \n2. Navigate to Profiler global settings or license page.  \n3. Attempt to disable Profiler feature or remove Profiler license (depending on UI capabilities).  \n4. Confirm any warning prompts.  \n5. Check if DHCP configuration pages become inaccessible or read-only.  \n6. Connect a new endpoint and trigger DHCP to see if profiling still occurs.  \n**Expected Results:**  \n- System either prevents disabling Profiler while active (with warning) or proceeds but cleanly stops collectors.  \n- After disablement, DHCP configuration pages are disabled or show Profiler is not active.  \n- No new DHCP-based endpoint is profiled after Profiler is disabled.  \n- Existing device records remain in a read-only state.  \n**Postconditions:**  \n- Profiler remains disabled until re-enabled; no partial, inconsistent state.\n\n---",
  "test_plan": ": TEST PLANNING ANALYSIS\n\n1. **Feature Overview**  \nProfiler DHCP configuration covers how Pulse Policy Secure’s Profiler component captures and uses DHCPv4/DHCPv6 traffic (via DHCP Helper/IP relay, SPAN/RSPAN, and broadcast) to fingerprint endpoints, integrate with switches/WLCs, SNMP, and remote profilers, and leverage device fingerprint databases for classification. It includes enabling/disabling DHCPv6Collector, setting sniffing modes, and managing fingerprint database versions.\n\n2. **Test Objectives**  \n- Validate correct DHCPv4 and DHCPv6 packet capture across supported modes (broadcast, relay, SPAN/RSPAN).  \n- Confirm accurate device discovery and classification based on DHCP fingerprints and fingerprint DB version.  \n- Ensure robust behavior under misconfiguration, malformed packets, and boundary conditions (DB version, MAC auth limits, option lengths).  \n- Verify integrations with switches, WLCs, SNMP collectors, and remote Profiler/PPS instances.  \n- Confirm security controls (admin access control, input sanitization) around DHCP-derived data and configuration screens.  \n- Assess performance and stability under high-volume and sustained dual-stack DHCP loads.\n\n3. **Coverage Analysis**  \n- Positive: 5 tests (TC_001, TC_002, TC_003, TC_004, TC_005)  \n- Negative: 5 tests (TC_006, TC_007, TC_008, TC_018, TC_020)  \n- Boundary: 3 tests (TC_009, TC_010, TC_011)  \n- Integration: 4 tests (TC_012, TC_013, TC_019, plus MAC auth integration aspects in TC_011)  \n- Security: 2 tests (TC_014, TC_015)  \n- Performance: 2 tests (TC_016, TC_017)  \n\nThis distribution fits the requested proportions and covers main DHCP configuration paths, IPv4/IPv6, helper vs SPAN, fingerprint DB, and downstream integrations.\n\n4. **Risk Areas**  \n- **Packet capture correctness**: Misconfigured DHCP Helper or SPAN, wrong sniffing mode, or IPv6 collector misconfig may silently prevent profiling.  \n- **Classification accuracy**: Outdated fingerprint DB or malformed/massive DHCP options can cause misclassification.  \n- **Scalability**: High DHCP load, dual-stack environments, and large MAC auth deployments may stress Profiler collectors and caches.  \n- **Security**: DHCP options are untrusted input; XSS/SQL injection through hostnames/vendor classes must be avoided. Access to configuration must be tightly restricted.  \n- **Delayed config application**: 15-minute delay for configuration changes may confuse operations; need to ensure behavior is predictable and logged.\n\nAdditional regression and exploratory testing around UI workflows, logging/diagnostics, and failover/high-availability would further strengthen coverage in a full test plan.",
  "validation_report": null,
  "metadata": {
    "user_prompt": "Profiler DHCP configuration",
    "intent": "configuration",
    "feature_name": "Profiler DHCP configuration",
    "sources_count": 3,
    "sources": [
      "20260104_124859_PP-Functional_Specification_for_Profiler_IPv6_support_-_Phase_3-041225-084335.pdf",
      "ps-pps-9.1r10.0-profiler-administration-guide.pdf",
      "PP-Profiler FAQ-041225-083737.pdf"
    ],
    "rag_results_count": 10
  },
  "output_files": {
    "json": "C:\\Users\\SaiShravan.V\\OneDrive - Ivanti\\Desktop\\POC\\data\\test_cases\\test_cases_20260105_220131.json",
    "markdown": "C:\\Users\\SaiShravan.V\\OneDrive - Ivanti\\Desktop\\POC\\data\\test_cases\\test_cases_20260105_220131.md",
    "excel": "C:\\Users\\SaiShravan.V\\OneDrive - Ivanti\\Desktop\\POC\\data\\test_cases\\test_cases_20260105_220131.xlsx"
  },
  "script_status": "generated",
  "script_file": "C:\\Users\\SaiShravan.V\\OneDrive - Ivanti\\Desktop\\POC\\data\\jobs\\4d8529a8\\scripts",
  "script_files": {},
  "error": null
}