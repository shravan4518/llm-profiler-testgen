{
  "job_id": "fca0b0e8",
  "user_prompt": "Test Device Discovery Rules",
  "model": "gpt-4.1-nano",
  "parameters": {
    "output_formats": [
      "json",
      "markdown",
      "excel"
    ],
    "use_iteration": true
  },
  "target_config": {
    "url": "https://10.34.50.201/dana-na/auth/url_admin/welcome.cgi",
    "username": "shravan",
    "password": "asdad",
    "browser": "chromium",
    "environment": "dev"
  },
  "status": "completed",
  "created_at": "2026-01-20T10:43:16.866549",
  "updated_at": "2026-01-20T10:44:40.933311",
  "test_cases": ": COMPREHENSIVE TEST CASES\n\n#### TC_001\n**Test Title:** Enable Device Discovery with default options and valid IP range  \n**Category:** positive  \n**Priority:** Critical  \n**Description:** Verify that an administrator can enable Device Discovery with default protocol/method options and a valid IPv4 range, and that discovery successfully runs and populates the Device Discovery Report Table.  \n**Prerequisites:**  \n- Administrator account with full Profiler/Device Discovery permissions.  \n- System reachable at `https://pps-admin.corp.local`.  \n- Network segment `192.168.10.0/24` has a few active devices (Windows, Linux, network switch).  \n- Profiler service running.  \n\n**Test Data:**  \n- Login: `admin` / `Adm1n!Pass`  \n- Device Discovery page path: Endpoint Policy > Device Discovery  \n- IP range: `192.168.10.1-192.168.10.254`  \n\n**Test Steps:**  \n1. Log in to Pulse Policy Secure admin UI at `https://pps-admin.corp.local` using `admin / Adm1n!Pass`.  \n2. Navigate to Endpoint Policy > Device Discovery.  \n3. Check the **Enable Device Discovery** checkbox.  \n4. In **Discovery Settings**, enter `192.168.10.1-192.168.10.254` in the \"Add IP range or hostname\" field.  \n5. Ensure default discovery protocols (e.g., DHCP, ARP/SNMP, SSH, CDP/LLDP if listed) are enabled (leave all pre-checked defaults on).  \n6. Leave discovery methods at default (e.g., \"Active scan\" or equivalent; do not select \"Import from File\").  \n7. Click **Test & Save**.  \n8. Confirm any “test successful” message and then trigger discovery if not auto-started (click **Discover** or green **Device Discovery** button, depending on UI).  \n9. Wait for discovery to complete or for status to show \"Completed\" / \"Idle\".  \n10. Navigate to System > Reports > Device Discovery (or Profiler > Dashboard and Report > Device Discovery report).  \n11. Check that devices from `192.168.10.0/24` appear in the Device Discovery Report Table.  \n\n**Expected Results:**  \n- Device Discovery configuration is saved successfully with no error messages.  \n- \"Test & Save\" indicates success.  \n- Discovery run completes without error.  \n- Devices in the specified range are discovered and listed in the Device Discovery Report Table with attributes such as IP Address, Operating System, Last Discovered, Manufacturer, etc.  \n- The Dashboard shows an overall summary reflecting the newly discovered devices.  \n\n**Postconditions:**  \n- Device Discovery remains enabled.  \n- Discovery configuration for range `192.168.10.1-192.168.10.254` is stored and can be used for subsequent runs.  \n- Discovered devices are profiled and available in Device Discovery report and dashboard.\n\n---\n\n#### TC_002\n**Test Title:** Disable Device Discovery and verify no new devices are discovered  \n**Category:** positive  \n**Priority:** High  \n**Description:** Validate that disabling Device Discovery stops new discovery activities and prevents new devices from being added to the Device Discovery Report Table.  \n**Prerequisites:**  \n- Device Discovery previously enabled and configured with IP range `192.168.20.1-192.168.20.254`.  \n- At least one prior discovery run completed.  \n- New device added to network after last discovery at `192.168.20.50`.  \n\n**Test Data:**  \n- Existing discovery range: `192.168.20.1-192.168.20.254`  \n- New device IP: `192.168.20.50` (powered on after last discovery)  \n\n**Test Steps:**  \n1. Log in as `admin / Adm1n!Pass`.  \n2. Navigate to Endpoint Policy > Device Discovery.  \n3. Uncheck the **Enable Device Discovery** checkbox.  \n4. Click **Test & Save** (if allowed when disabled) or **Save**.  \n5. Confirm that no discovery schedule or manual discover button is running (ensure discovery status shows \"Disabled\" or similar).  \n6. Wait longer than the normal discovery interval (e.g., 30 minutes) or manually confirm no forced discovery is triggered.  \n7. Navigate to System > Reports > Device Discovery.  \n8. Filter by IP `192.168.20.50` in the Device Discovery Report Table.  \n\n**Expected Results:**  \n- Configuration is saved successfully with Device Discovery set to disabled.  \n- No new discovery runs are triggered automatically.  \n- The device at `192.168.20.50` does not appear in the Device Discovery Report Table.  \n- No entries in device action logs indicating discovery of new devices after disable time.  \n\n**Postconditions:**  \n- Device Discovery remains disabled.  \n- No new devices discovered until feature is re-enabled.\n\n---\n\n#### TC_003\n**Test Title:** Configure Device Discovery with multiple device-type options (Pulse One, PCS, PPS, Workspace, Client)  \n**Category:** positive  \n**Priority:** Medium  \n**Description:** Verify that enabling specific device-type discovery options (Pulse One, Pulse Connect Secure, Pulse Policy Secure, Pulse Workspace, Pulse Secure Client) results in discovery of those device types within the configured scope.  \n**Prerequisites:**  \n- Environment contains:  \n  - Pulse One server at `10.1.1.10`  \n  - PCS appliance at `10.1.1.11`  \n  - PPS appliance at `10.1.1.12`  \n  - Pulse Workspace backend at `10.1.1.13`  \n  - Several endpoints running Pulse Secure Client in subnet `10.1.1.0/24`.  \n\n**Test Data:**  \n- Discovery IP range: `10.1.1.1-10.1.1.254`  \n\n**Test Steps:**  \n1. Log in as `admin / Adm1n!Pass`.  \n2. Navigate to Endpoint Policy > Device Discovery.  \n3. Ensure **Enable Device Discovery** is checked.  \n4. In \"Discovery Options\" section, check the following:  \n   - **Pulse One**  \n   - **Pulse Connect Secure**  \n   - **Pulse Policy Secure**  \n   - **Pulse Workspace**  \n   - **Pulse Secure Client**  \n5. Enter `10.1.1.1-10.1.1.254` in the \"Add IP range or hostname\" field.  \n6. Enable **Integration with Monitoring & Tools** checkbox (if present).  \n7. Click **Test & Save**.  \n8. Trigger discovery (click **Discover** or equivalent).  \n9. After completion, go to System > Reports > Device Discovery.  \n10. Filter or sort by device type or OS/category to locate the Pulse-specific devices.  \n\n**Expected Results:**  \n- Configuration is saved successfully with all specified discovery options enabled.  \n- Discovery run completes without errors.  \n- Pulse One, PCS, PPS, Pulse Workspace servers, and endpoints running Pulse Secure Client are discovered and listed.  \n- Device type/category or attributes clearly indicate each Pulse product.  \n\n**Postconditions:**  \n- Device Discovery configuration remains with specified options enabled.  \n- Discovered Pulse devices persist in Device Discovery report.\n\n---\n\n#### TC_004\n**Test Title:** Import discovery targets from file using \"Import from File\" method  \n**Category:** positive  \n**Priority:** High  \n**Description:** Validate that using the \"Import from File\" discovery method correctly imports a list of IPs/hostnames and discovers devices accordingly.  \n**Prerequisites:**  \n- Admin access.  \n- CSV file `discovery_targets.csv` prepared and accessible from admin client machine with lines:  \n  - `192.168.30.10`  \n  - `192.168.30.11`  \n  - `switch-core.corp.local`  \n\n**Test Data:**  \n- File: `C:\\TestFiles\\discovery_targets.csv` (or equivalent path)  \n\n**Test Steps:**  \n1. Log in as `admin / Adm1n!Pass`.  \n2. Navigate to Endpoint Policy > Device Discovery.  \n3. Ensure **Enable Device Discovery** is checked.  \n4. In **Discovery Methods**, select **Import from File**.  \n5. Click the file selection/browse button and select `discovery_targets.csv` from local filesystem.  \n6. Ensure no manual IP range is entered (if both allowed, leave range empty).  \n7. Click **Test & Save**.  \n8. Trigger discovery.  \n9. After completion, open System > Reports > Device Discovery.  \n10. Verify entries for `192.168.30.10`, `192.168.30.11`, and `switch-core.corp.local` (resolved IP) exist.  \n\n**Expected Results:**  \n- File is accepted without format errors.  \n- Discovery run completes.  \n- All IPs/hostnames in the file that are reachable are discovered and present in the Device Discovery report with correct IP, hostname, first_seen timestamps.  \n- No extra devices outside of those defined in the file are discovered (if no other scope configured).  \n\n**Postconditions:**  \n- Imported targets remain in configuration or history as per product design.  \n- Discovered devices listed in Device Discovery report.\n\n---\n\n#### TC_005\n**Test Title:** View and modify a discovered device from Device Discovery Report Table  \n**Category:** positive  \n**Priority:** Medium  \n**Description:** Verify that an admin can open, modify, and save details of a discovered device via the Device Discovery Report Table.  \n**Prerequisites:**  \n- At least one discovered device present in Device Discovery report (e.g., `192.168.10.5`).  \n\n**Test Data:**  \n- Device IP: `192.168.10.5`  \n- New device hostname: `ADMIN-PC-UPDATED`  \n\n**Test Steps:**  \n1. Log in as `admin / Adm1n!Pass`.  \n2. Navigate to System > Reports > Device Discovery.  \n3. In the Device Discovery Report Table, search/filter for IP `192.168.10.5`.  \n4. Select the checkbox next to the device.  \n5. Click the **Modify** button below the table.  \n6. In the modify dialog/page, update the Hostname field to `ADMIN-PC-UPDATED`.  \n7. Optionally add a group tag (e.g., add to group \"Managed-Endpoints\").  \n8. Click **Save Changes**.  \n9. Refresh the Device Discovery report page.  \n10. Confirm the updated hostname and groups are shown in the table.  \n\n**Expected Results:**  \n- Modify dialog opens successfully for the selected device.  \n- Changing hostname and groups is allowed.  \n- Saving changes succeeds with confirmation message and no errors.  \n- Device entry reflects updated attributes in the table and in any relevant dashboards.  \n\n**Postconditions:**  \n- Modified device record persists with new hostname and group.  \n\n---\n\n#### TC_006\n**Test Title:** Delete endpoint from Device Discovery Report Table  \n**Category:** positive  \n**Priority:** Medium  \n**Description:** Validate that an endpoint can be deleted from the Device Discovery Report Table and is removed from subsequent reports.  \n**Prerequisites:**  \n- At least one device entry (e.g., IP `192.168.10.8`) in Device Discovery report.  \n\n**Test Data:**  \n- Device IP: `192.168.10.8`  \n\n**Test Steps:**  \n1. Log in as `admin / Adm1n!Pass`.  \n2. Navigate to System > Reports > Device Discovery.  \n3. Locate the device IP `192.168.10.8` in the report table.  \n4. Select the checkbox next to `192.168.10.8`.  \n5. Click **Delete** (or equivalent Device Operations delete option).  \n6. Confirm deletion in any confirmation dialog.  \n7. Refresh the Device Discovery report.  \n8. Verify that `192.168.10.8` no longer appears.  \n\n**Expected Results:**  \n- Delete operation prompts a confirmation and, once confirmed, succeeds.  \n- Device entry is removed from Device Discovery report and does not appear in Device Operations or dashboard summaries (unless rediscovered in future runs).  \n\n**Postconditions:**  \n- Device `192.168.10.8` is removed from report until next discovery finds it again (if device still on network).\n\n---\n\n#### TC_007\n**Test Title:** Attempt to save Device Discovery configuration with invalid IP range format  \n**Category:** negative  \n**Priority:** Critical  \n**Description:** Verify validation prevents saving discovery configuration when an IP range is malformed.  \n**Prerequisites:**  \n- Admin access.  \n\n**Test Data:**  \n- Invalid IP range inputs to attempt:  \n  - `192.168.300.1-192.168.300.10`  \n  - `192.168.1.10-`  \n  - `-192.168.1.20`  \n  - `192.168.1.20-192.168.1.10` (reverse order)  \n\n**Test Steps:**  \n1. Log in as `admin / Adm1n!Pass`.  \n2. Navigate to Endpoint Policy > Device Discovery.  \n3. Ensure **Enable Device Discovery** is checked.  \n4. In \"Add IP range or hostname\" field, enter `192.168.300.1-192.168.300.10`.  \n5. Click **Test & Save**.  \n6. Observe validation messages.  \n7. Repeat steps 4–6 for each invalid input listed above, clearing or replacing the previous value each time.  \n\n**Expected Results:**  \n- System rejects each invalid input with clear error messages (e.g., \"Invalid IP address\", \"Range start must be less than range end\", \"IP range cannot be empty\").  \n- Configuration is not saved when invalid IP range is present.  \n- Device Discovery status and previous valid configuration remain unchanged.  \n\n**Postconditions:**  \n- No change to active Device Discovery configuration.  \n- No discovery runs triggered from invalid configuration.\n\n---\n\n#### TC_008\n**Test Title:** Attempt discovery with unreachable hostname in scope  \n**Category:** negative  \n**Priority:** High  \n**Description:** Verify system handles discovery of unreachable hostnames gracefully without impacting discovery of other reachable devices.  \n**Prerequisites:**  \n- At least one reachable device in range (`10.0.0.5`).  \n- Nonexistent hostname `no-such-host.corp.local`.  \n\n**Test Data:**  \n- Discovery scope: \n  - Hostname: `no-such-host.corp.local`  \n  - IP range: `10.0.0.5-10.0.0.5`  \n\n**Test Steps:**  \n1. Log in as `admin / Adm1n!Pass`.  \n2. Navigate to Endpoint Policy > Device Discovery.  \n3. Ensure **Enable Device Discovery** is checked.  \n4. In \"Add IP range or hostname\", enter two targets (as allowed by UI):  \n   - `no-such-host.corp.local`  \n   - `10.0.0.5-10.0.0.5`  \n5. Click **Test & Save**.  \n6. Trigger discovery.  \n7. After completion, navigate to System > Reports > Device Discovery.  \n8. Check for a device entry for `10.0.0.5`.  \n9. Verify there is no successful entry for `no-such-host.corp.local`, but check logs/status messages for error/warning.  \n\n**Expected Results:**  \n- Discovery run completes but logs warnings/errors for unreachable hostname.  \n- Device at `10.0.0.5` is discovered and listed.  \n- No system crash or hang; error handling is graceful.  \n- UI may show per-target results indicating failure for unreachable host.  \n\n**Postconditions:**  \n- Discovered IP device remains in report.  \n- Unreachable hostname is not added as a device.\n\n---\n\n#### TC_009\n**Test Title:** Disable all discovery protocols and run discovery  \n**Category:** negative  \n**Priority:** Medium  \n**Description:** Validate that if all discovery protocols are disabled, the system either prevents starting discovery or runs but discovers no devices, with appropriate warnings.  \n**Prerequisites:**  \n- Admin access.  \n\n**Test Data:**  \n- Discovery range: `192.168.40.1-192.168.40.50`  \n\n**Test Steps:**  \n1. Log in as `admin / Adm1n!Pass`.  \n2. Navigate to Endpoint Policy > Device Discovery.  \n3. Ensure **Enable Device Discovery** is checked.  \n4. In **Discovery Protocols** section, uncheck all available protocol options (e.g., DHCP, SNMP, SSH, CDP/LLDP).  \n5. Enter `192.168.40.1-192.168.40.50` in the scope.  \n6. Click **Test & Save**.  \n7. Initiate discovery.  \n8. Observe any validation error or warning before run starts.  \n9. After completion, check System > Reports > Device Discovery for any new entries in `192.168.40.1-50`.  \n\n**Expected Results:**  \n- System either:  \n  - Prevents saving/starting discovery with message like \"At least one protocol must be enabled\", OR  \n  - Allows run but no devices are discovered and logs indicate no protocols active.  \n- No devices from the test range appear newly in the Device Discovery report.  \n\n**Postconditions:**  \n- Discovery remains misconfigured (no protocols) unless user corrects it.  \n- No new devices discovered from this run.\n\n---\n\n#### TC_010\n**Test Title:** Unauthorized user attempts to access Device Discovery configuration  \n**Category:** negative  \n**Priority:** Critical  \n**Description:** Validate that a user without the required admin privileges cannot view or modify Device Discovery settings.  \n**Prerequisites:**  \n- Non-admin user account `auditor1` with read-only reporting access but no configuration permissions.  \n\n**Test Data:**  \n- Login: `auditor1` / `Aud1t0r!`  \n\n**Test Steps:**  \n1. Log in as `auditor1 / Aud1t0r!`.  \n2. Attempt to navigate directly to Endpoint Policy > Device Discovery via menu.  \n3. If menu item not visible, try direct URL access to Device Discovery configuration page (e.g., `https://pps-admin.corp.local/device-discovery`).  \n4. Attempt to modify any visible fields and click **Save** if the page loads.  \n\n**Expected Results:**  \n- Device Discovery menu item is hidden or disabled for `auditor1`.  \n- Direct URL access is denied with proper authorization error (e.g., HTTP 403 or \"Access Denied\" page).  \n- No changes are allowed; no configuration is saved.  \n\n**Postconditions:**  \n- Device Discovery configuration remains unchanged.  \n- Access logs show unauthorized access attempts as per security policy.\n\n---\n\n#### TC_011\n**Test Title:** Boundary test - minimum single IP as discovery scope  \n**Category:** boundary  \n**Priority:** High  \n**Description:** Verify that a discovery scope consisting of a single IP address (minimal range) is accepted and processed correctly.  \n**Prerequisites:**  \n- Device at `172.16.0.10` active on network.  \n\n**Test Data:**  \n- Discovery scope: `172.16.0.10-172.16.0.10`  \n\n**Test Steps:**  \n1. Log in as `admin / Adm1n!Pass`.  \n2. Navigate to Endpoint Policy > Device Discovery.  \n3. Ensure **Enable Device Discovery** is checked.  \n4. Enter `172.16.0.10-172.16.0.10` in \"Add IP range or hostname\".  \n5. Click **Test & Save**.  \n6. Start discovery.  \n7. After completion, navigate to System > Reports > Device Discovery.  \n8. Verify that the device at `172.16.0.10` is discovered and displayed.  \n\n**Expected Results:**  \n- Single-IP range is accepted as valid.  \n- Discovery run completes successfully.  \n- Device `172.16.0.10` is discovered and visible in report.  \n\n**Postconditions:**  \n- Single-IP discovery range remains in configuration (if not removed).\n\n---\n\n#### TC_012\n**Test Title:** Boundary test - maximum supported IPv4 range on UI field  \n**Category:** boundary  \n**Priority:** High  \n**Description:** Validate maximum allowed length and size of IP range accepted by the UI and backend (e.g., full /16 or similar), and ensure system performance and correctness.  \n**Prerequisites:**  \n- Understanding of environment capacity (e.g., safe to test on `10.50.0.0/16`).  \n\n**Test Data:**  \n- Discovery scope: `10.50.0.1-10.50.255.254`  \n\n**Test Steps:**  \n1. Log in as `admin / Adm1n!Pass`.  \n2. Navigate to Endpoint Policy > Device Discovery.  \n3. Ensure **Enable Device Discovery** is checked.  \n4. Enter `10.50.0.1-10.50.255.254` into \"Add IP range or hostname\".  \n5. Click **Test & Save**.  \n6. Observe immediate validation—ensure no \"value too long\" or format errors.  \n7. Optionally initiate discovery in a controlled test environment (or just validate acceptance if full run is not feasible).  \n8. Monitor UI and logs for any immediate errors due to size.  \n\n**Expected Results:**  \n- Field accepts maximum-length range without truncation or client-side errors.  \n- Server-side saves configuration or provides explicit message if range exceeds supported limits (e.g., “Range too large, maximum X hosts”).  \n- No UI crashes or unhandled exceptions.  \n\n**Postconditions:**  \n- If saved, large range remains in configuration; may need to be manually reduced after test.  \n\n---\n\n#### TC_013\n**Test Title:** Boundary test - empty discovery scope with Device Discovery enabled  \n**Category:** boundary  \n**Priority:** Medium  \n**Description:** Verify system behavior when Device Discovery is enabled but no IP range/hostname/import file is specified.  \n**Prerequisites:**  \n- Admin access.  \n\n**Test Data:**  \n- Scope: empty  \n\n**Test Steps:**  \n1. Log in as `admin / Adm1n!Pass`.  \n2. Navigate to Endpoint Policy > Device Discovery.  \n3. Check **Enable Device Discovery**.  \n4. Clear any existing values in \"Add IP range or hostname\".  \n5. Ensure **Discovery Methods** is not set to \"Import from File\" or no file is attached.  \n6. Click **Test & Save**.  \n7. Attempt to trigger discovery.  \n\n**Expected Results:**  \n- Either:  \n  - System prevents saving with a validation message \"Discovery scope required\", OR  \n  - System allows save but prevents starting discovery with a clear error message.  \n- No discovery run actually takes place.  \n\n**Postconditions:**  \n- No new devices discovered.  \n- Configuration may remain incomplete until corrected.\n\n---\n\n#### TC_014\n**Test Title:** Integration - SNMP v2c Network Infrastructure Device Collector for static IP endpoints  \n**Category:** integration  \n**Priority:** Critical  \n**Description:** Validate integration with Network Infrastructure Device (switch) via SNMP v2c for discovering statically addressed endpoints through ARP/CAM table.  \n**Prerequisites:**  \n- Core switch `switch-core1.corp.local` (IP `192.168.100.1`) configured with SNMP v2c community `profiler-public`.  \n- Profiler SNMP reachability to `192.168.100.1`.  \n- Several endpoints with static IPs `192.168.100.50`, `192.168.100.51` connected to the switch.  \n\n**Test Data:**  \n- SNMP Device Group: `Core Switches`  \n- Device Type: `Network Infrastructure Device`  \n- SNMP version: v2c  \n- Community: `profiler-public`  \n\n**Test Steps:**  \n1. Log in as `admin / Adm1n!Pass`.  \n2. Navigate to Profiler > Profiler Configuration > Network Infrastructure Device Collector (or Device Sponsoring if that’s where SNMP discovery is).  \n3. Add a new SNMP device entry:  \n   - Device Group: `Core Switches`  \n   - Device Type: `Network Infrastructure Device`  \n   - IP: `192.168.100.1`  \n   - SNMP v2c selected.  \n   - Community: `profiler-public`.  \n4. Click **Discover** on this SNMP configuration screen.  \n5. Monitor logs/status for SNMP query success and ARP/CAM table fetch.  \n6. After completion, navigate to System > Reports > Device Discovery.  \n7. Filter for network `192.168.100.0/24` or specific IPs `192.168.100.50`, `192.168.100.51`.  \n\n**Expected Results:**  \n- SNMP connectivity to `192.168.100.1` succeeds (no authentication errors).  \n- Profiler retrieves ARP/CAM data from the switch.  \n- Static endpoints with IPs `192.168.100.50` and `192.168.100.51` are discovered and listed in Device Discovery report.  \n- Device attributes include MAC address, Manufacturer, possibly OS based on fingerprinting.  \n\n**Postconditions:**  \n- Switch remains configured as SNMP network device for periodic polling per configured poll interval.  \n- Discovered static endpoints remain in report and are updated periodically.\n\n---\n\n#### TC_015\n**Test Title:** Integration - CDP/LLDP-based discovery for enhanced OS/model information  \n**Category:** integration  \n**Priority:** High  \n**Description:** Validate that CDP/LLDP announcements received from network devices are used to enhance discovery with more accurate OS/model/category information.  \n**Prerequisites:**  \n- Network devices (e.g., Cisco switch `10.2.0.2`, LLDP-speaking AP `10.2.0.3`) configured to send CDP/LLDP.  \n- Profiler configured to listen/collect CDP/LLDP (protocols enabled).  \n\n**Test Data:**  \n- IP range: `10.2.0.1-10.2.0.10`  \n\n**Test Steps:**  \n1. Log in as `admin / Adm1n!Pass`.  \n2. Navigate to Endpoint Policy > Device Discovery.  \n3. Ensure **Enable Device Discovery** is checked.  \n4. Under Discovery Protocols, verify CDP/LLDP collection is enabled.  \n5. Scope: set IP range `10.2.0.1-10.2.0.10`.  \n6. Click **Test & Save**.  \n7. Trigger discovery.  \n8. After completion, navigate to Device Discovery report.  \n9. Locate entries for `10.2.0.2` and `10.2.0.3`.  \n10. Inspect attributes including OS, model, category.  \n\n**Expected Results:**  \n- CDP/LLDP data is successfully collected.  \n- Discovered devices show more accurate OS and model information (e.g., “Cisco IOS 15.x”, “Ruckus Wireless AP”) and proper categories (e.g., “Network Switch”, “Wireless AP”).  \n- No errors in logs for CDP/LLDP collection.  \n\n**Postconditions:**  \n- CDP/LLDP-based profiling is active for subsequent discovery cycles.\n\n---\n\n#### TC_016\n**Test Title:** Integration - Verify discovered devices are forwarded/synced to configured external system  \n**Category:** integration  \n**Priority:** Medium  \n**Description:** Ensure that devices discovered by Profiler are forwarded/synchronized to an external endpoint repository or directory when forward/sync is configured.  \n**Prerequisites:**  \n- Forward and Sync endpoints configuration set up (Profiler > Profiler Configuration > Forward and Sync endpoints).  \n- Target system (e.g., CMDB at `cmdb.corp.local`) reachable and configured.  \n\n**Test Data:**  \n- New device to discover: endpoint at `192.168.60.20`.  \n\n**Test Steps:**  \n1. Confirm Forward and Sync configuration is enabled and saved (e.g., via Profiler > Profiler Configuration > Forward and Sync endpoints).  \n2. Log in as `admin / Adm1n!Pass`.  \n3. Run a device discovery that includes `192.168.60.20` in its scope.  \n4. After discovery finishes, confirm `192.168.60.20` is listed in Device Discovery report.  \n5. Access external system (CMDB) UI or database.  \n6. Search for `192.168.60.20` in the external system.  \n\n**Expected Results:**  \n- Device `192.168.60.20` appears in Device Discovery report.  \n- Within a reasonable sync interval, `192.168.60.20` is also present in the external system with key attributes (hostname, IP, MAC, OS, etc.).  \n- No sync errors reported in logs.  \n\n**Postconditions:**  \n- Sync relationship remains active; discovered devices continue to be forwarded.\n\n---\n\n#### TC_017\n**Test Title:** Security - Prevent SQL injection via hostname/IP input field  \n**Category:** security  \n**Priority:** Critical  \n**Description:** Validate that input fields for \"Add IP range or hostname\" are not vulnerable to SQL injection.  \n**Prerequisites:**  \n- Admin access.  \n\n**Test Data:**  \n- Malicious input examples:  \n  - `192.168.1.10; DROP TABLE devices;--`  \n  - `' OR '1'='1`  \n  - `10.0.0.1'); UPDATE users SET role='admin' WHERE username='guest';--`  \n\n**Test Steps:**  \n1. Log in as `admin / Adm1n!Pass`.  \n2. Navigate to Endpoint Policy > Device Discovery.  \n3. In \"Add IP range or hostname\", enter `192.168.1.10; DROP TABLE devices;--`.  \n4. Click **Test & Save**.  \n5. Observe response and logs (if accessible).  \n6. Repeat with the other malicious inputs.  \n7. After each attempt, navigate to Device Discovery report, other key pages, and confirm system is functional.  \n\n**Expected Results:**  \n- Inputs are rejected with a validation error OR sanitized and treated as simple text (no SQL executed).  \n- No internal server error pages.  \n- No data corruption in Device Discovery report or other tables.  \n- System remains fully functional; no tables or data are lost.  \n\n**Postconditions:**  \n- Device Discovery configuration remains safe and consistent.  \n\n---\n\n#### TC_018\n**Test Title:** Security - Verify access control on Device Discovery Report operations (add/modify/delete)  \n**Category:** security  \n**Priority:** High  \n**Description:** Ensure that only authorized users can add, modify, or delete endpoints from Device Discovery Report Table.  \n**Prerequisites:**  \n- Admin user `admin` with full rights.  \n- Read-only user `reportviewer` with permission to view reports but not modify.  \n- At least one device in report.  \n\n**Test Data:**  \n- `reportviewer / RepV13w!`  \n\n**Test Steps:**  \n1. Log in as `reportviewer / RepV13w!`.  \n2. Navigate to System > Reports > Device Discovery.  \n3. Try to select a device in the table and look for **Modify**, **Delete**, or **Add** buttons.  \n4. If such buttons are visible, try to click and perform actions.  \n5. Log out and log in as `admin / Adm1n!Pass`.  \n6. Repeat step 2–4 with admin user.  \n\n**Expected Results:**  \n- For `reportviewer`, only view/filter/sort actions are available; no modify/delete/add options or actions succeed.  \n- Any attempts to call modification endpoints (even via crafted requests) are denied with appropriate authorization error.  \n- For `admin`, full add/modify/delete operations are available and functional.  \n\n**Postconditions:**  \n- Permissions remain unchanged.  \n- No unauthorized changes made by `reportviewer`.\n\n---\n\n#### TC_019\n**Test Title:** Performance - Discovery of moderate subnet within acceptable response time  \n**Category:** performance  \n**Priority:** Medium  \n**Description:** Verify that discovery of a /24 subnet completes within acceptable time and does not degrade system performance.  \n**Prerequisites:**  \n- Subnet `192.168.70.0/24` with about 50–100 active devices.  \n- Performance monitoring tools or baseline expectations (e.g., completion within 10 minutes).  \n\n**Test Data:**  \n- Discovery range: `192.168.70.1-192.168.70.254`  \n\n**Test Steps:**  \n1. Log in as `admin / Adm1n!Pass`.  \n2. Navigate to Endpoint Policy > Device Discovery.  \n3. Configure scope `192.168.70.1-192.168.70.254`.  \n4. Click **Test & Save**.  \n5. Start discovery and note the start time.  \n6. Monitor Discovery status page until completion, noting end time.  \n7. During discovery, monitor CPU and memory usage on Profiler server.  \n8. After completion, confirm all expected devices are listed in Device Discovery report.  \n\n**Expected Results:**  \n- Discovery completes within the defined SLA (e.g., under 10 minutes for 50–100 devices).  \n- Profiler server CPU and memory usage remain within acceptable thresholds (no sustained 100% CPU, no memory exhaustion).  \n- UI remains responsive during discovery.  \n\n**Postconditions:**  \n- Discovered devices remain in report.  \n\n---\n\n#### TC_020\n**Test Title:** Performance - Concurrent discovery runs with overlapping ranges  \n**Category:** performance  \n**Priority:** High  \n**Description:** Validate system behavior and performance under multiple concurrent discovery tasks (if system supports multi-job scheduling), and ensure locking/queuing avoids conflicts.  \n**Prerequisites:**  \n- Capability to schedule or trigger multiple discovery jobs (e.g., different scopes, or manual trigger while scheduled job runs).  \n\n**Test Data:**  \n- Range A: `192.168.80.1-192.168.80.100`  \n- Range B: `192.168.80.50-192.168.80.150`  \n\n**Test Steps:**  \n1. Configure Discovery Job A for scope `192.168.80.1-192.168.80.100`.  \n2. Start Job A.  \n3. Immediately configure Discovery Job B or manually change scope to `192.168.80.50-192.168.80.150` and start Job B (if UI supports multiple jobs) or attempt to start another run.  \n4. Observe system behavior: see if jobs are queued, rejected, or executed concurrently.  \n5. Monitor performance metrics and Device Discovery report after both runs complete.  \n\n**Expected Results:**  \n- System either:  \n  - Queues second job until first completes, or  \n  - Allows concurrent runs with safeguards so that no data corruption occurs.  \n- No duplicate inconsistent entries in Device Discovery report; overlapping IPs appear once with latest correct attributes.  \n- Performance degradation remains within acceptable limits; no crashes or timeouts.  \n\n**Postconditions:**  \n- Combined discovery results for the overlapping subnet are correct and stable.  \n\n---\n\n#### TC_021\n**Test Title:** Negative - Invalid SNMP credentials for Network Infrastructure Device Collector  \n**Category:** negative  \n**Priority:** High  \n**Description:** Validate error handling when SNMP credentials are incorrect for a network device.  \n**Prerequisites:**  \n- Switch `192.168.90.1` configured with SNMP community `correct-public`.  \n\n**Test Data:**  \n- SNMP community attempted: `wrong-public`  \n\n**Test Steps:**  \n1. Log in as `admin / Adm1n!Pass`.  \n2. Navigate to Profiler > Profiler Configuration > Network Infrastructure Device Collector.  \n3. Add a new SNMP device entry for `192.168.90.1` with SNMP v2c community `wrong-public`.  \n4. Click **Discover**.  \n5. Monitor UI and logs for errors.  \n\n**Expected Results:**  \n- Discovery fails with clear SNMP authentication/authorization error message.  \n- No ARP/CAM data is imported from this device.  \n- No bogus entries are created in Device Discovery report for endpoints behind this switch.  \n\n**Postconditions:**  \n- Misconfigured SNMP device entry remains until corrected or removed.  \n\n---\n\n#### TC_022\n**Test Title:** Boundary/Security - Maximum length of hostname input and handling of special characters  \n**Category:** boundary  \n**Priority:** Medium  \n**Description:** Verify maximum allowed length and acceptable character set for hostname entries, and that special characters do not cause errors or injection vulnerabilities.  \n**Prerequisites:**  \n- Admin access.  \n\n**Test Data:**  \n- Long hostname (63 chars label, total < 255 chars), e.g.:  \n  - `very-long-hostname-with-multiple-segments-01.corp-division.example.com`  \n- Hostname with special characters:  \n  - `host_name-with_underscores.corp.local`  \n  - `host$name#test.corp.local`  \n\n**Test Steps:**  \n1. Log in as `admin / Adm1n!Pass`.  \n2. Navigate to Endpoint Policy > Device Discovery.  \n3. In \"Add IP range or hostname\", enter the long hostname value.  \n4. Click **Test & Save** and observe behavior.  \n5. Repeat with `host_name-with_underscores.corp.local`.  \n6. Repeat with `host$name#test.corp.local`.  \n\n**Expected Results:**  \n- Hostnames within standard limits and allowed characters are accepted.  \n- Hostnames with illegal characters are rejected with clear validation messages.  \n- No buffer overruns, UI errors, or malicious script execution.  \n\n**Postconditions:**  \n- Only valid hostnames remain in configuration.  \n\n---\n\n#### TC_023\n**Test Title:** Integration - SNMP discovery with Device Group and Device Type selection  \n**Category:** integration  \n**Priority:** Medium  \n**Description:** Validate that selecting a Device Group and Device Type for SNMP discovery correctly classifies discovered devices.  \n**Prerequisites:**  \n- SNMP-reachable server at `10.10.10.50` providing standard system OIDs.  \n\n**Test Data:**  \n- Device Group: `Datacenter Devices`  \n- Device Type: `Server`  \n- SNMP version: v2c  \n\n**Test Steps:**  \n1. Log in as `admin / Adm1n!Pass`.  \n2. Navigate to the SNMP discovery interface (as described in spec: includes Device Group, Device Type, SNMP v2c radio).  \n3. Set Device Group to `Datacenter Devices`.  \n4. Set Device Type to `Server`.  \n5. Select SNMP v2c.  \n6. Enter IP `10.10.10.50`.  \n7. Click **Discover**.  \n8. After discovery, go to Device Discovery Report.  \n9. Locate `10.10.10.50` and inspect Group and Category/Type attributes.  \n\n**Expected Results:**  \n- Device `10.10.10.50` is discovered successfully.  \n- Device is assigned to group `Datacenter Devices` and device type/category \"Server\" as configured.  \n\n**Postconditions:**  \n- Classification persists and can be used for Profile Groups and Device Sponsoring.\n\n---\n\n#### TC_024\n**Test Title:** Security - XSS checks in Device Discovery filters and device attributes  \n**Category:** security  \n**Priority:** High  \n**Description:** Validate that any user-controlled fields displayed in Device Discovery UI are properly escaped and not vulnerable to cross-site scripting.  \n**Prerequisites:**  \n- Ability to insert a device with crafted hostname or group name (e.g., via external provisioning or test injection).  \n\n**Test Data:**  \n- Malicious hostname: `<script>alert('XSS')</script>`  \n\n**Test Steps:**  \n1. Using a controlled method (e.g., external sync or test device), create a device record whose hostname is `<script>alert('XSS')</script>`.  \n2. Log in as `admin / Adm1n!Pass`.  \n3. Navigate to System > Reports > Device Discovery.  \n4. Locate the device with the malicious hostname.  \n5. Observe how the hostname is rendered in the UI.  \n6. Use filters/search fields to search for `<script>alert('XSS')</script>`.  \n\n**Expected Results:**  \n- The hostname is displayed as escaped text (e.g., `&lt;script&gt;alert('XSS')&lt;/script&gt;`) and not executed as JavaScript.  \n- No alert pop-ups or script execution occurs.  \n- Filters/search fields do not execute scripts either.  \n\n**Postconditions:**  \n- No XSS remains active; entries can be cleaned or updated later.\n\n---\n\n#### TC_025\n**Test Title:** Negative - Device Discovery during Profiler service outage  \n**Category:** negative  \n**Priority:** Medium  \n**Description:** Validate system behavior when a discovery run is triggered while the Profiler backend service is stopped or becomes unavailable.  \n**Prerequisites:**  \n- Capability (for test) to stop/start Profiler backend service.  \n\n**Test Data:**  \n- Range: `192.168.200.1-192.168.200.10`  \n\n**Test Steps:**  \n1. Log in as `admin / Adm1n!Pass`.  \n2. Navigate to Endpoint Policy > Device Discovery and configure range `192.168.200.1-192.168.200.10`.  \n3. Ensure configuration is saved.  \n4. From server console, stop the Profiler backend service (simulate outage).  \n5. In UI, attempt to initiate discovery.  \n6. Observe error messages, timeouts, or UI behavior.  \n7. Restart the Profiler backend service.  \n8. Refresh UI and check if any partial or inconsistent entries exist in Device Discovery report.  \n\n**Expected Results:**  \n- While backend is down, discovery initiation fails gracefully with readable error (\"Service unavailable\" or similar), no hung UI.  \n- No partial devices are created.  \n- After service restart, UI returns to normal and Device Discovery configuration is intact.  \n\n**Postconditions:**  \n- System back to operational; Device Discovery available again after service restart.\n\n---",
  "test_plan": ": TEST PLANNING ANALYSIS\n\n1. **Feature Overview**  \n   - The tests cover Device Discovery in Pulse Policy Secure Profiler: enabling/disabling discovery, configuring scopes (IP ranges/hostnames/files), selecting discovery protocols and methods (DHCP, SNMP/SSH, CDP/LLDP), device-type options (Pulse One, PCS, PPS, Workspace, Client), executing discovery runs, and managing discovered devices via the Device Discovery Report Table and integrations (network infrastructure devices, forward & sync).\n\n2. **Test Objectives**  \n   - Validate that Device Discovery correctly discovers and profiles devices across various discovery methods and protocols.  \n   - Ensure configuration UI enforces proper validation for scopes, protocols, and SNMP parameters.  \n   - Confirm correct behavior of Device Discovery Report operations (add/modify/delete, grouping, classification).  \n   - Verify integrations with network infrastructure (SNMP, CDP/LLDP) and external systems (forward/sync).  \n   - Ensure robust security (authz, injection/XSS prevention) and predictable behavior under error and boundary conditions.  \n   - Confirm acceptable performance under realistic load and concurrent usage.\n\n3. **Coverage Analysis**  \n   - Positive: 6 tests (TC_001–TC_006)  \n   - Negative: 7 tests (TC_007, TC_008, TC_009, TC_010, TC_021, TC_025, partially TC_013)  \n   - Boundary: 4 tests (TC_011, TC_012, TC_013, TC_022)  \n   - Integration: 4 tests (TC_014, TC_015, TC_016, TC_023)  \n   - Security: 4 tests (TC_017, TC_018, TC_022 as boundary/security, TC_024)  \n   - Performance: 2 tests (TC_019, TC_020)  \n\n   Note: Some cases serve multiple dimensions (e.g., TC_022 covers boundary and security), but each has a primary category as requested.\n\n4. **Risk Areas / High-Priority Focus**  \n   - **Protocol integrations (SNMP, SSH, CDP/LLDP):** Incorrect handling can lead to incomplete discovery or inaccurate profiling, affecting policy decisions.  \n   - **Input validation (IP ranges, hostnames, SNMP credentials):** Malformed input can cause failures or security vulnerabilities (SQLi/XSS).  \n   - **Authorization & access control:** Misconfigured permissions could allow unauthorized users to manipulate discovery configuration or device records.  \n   - **Performance and scalability:** Large scopes or concurrent discovery jobs may overload Profiler if not managed properly.  \n   - **Data integrity in Device Discovery report:** Overlapping jobs, service outages, or faulty sync could create inconsistent device records.  \n\nThese tests form a baseline; additional data-driven variations (different subnets, IPv6 when supported, mixed DHCP/static environments) should be added for full regression and environment-specific validation.",
  "validation_report": null,
  "metadata": {
    "user_prompt": "Test Device Discovery Rules",
    "intent": "feature_description",
    "feature_name": "Device Discovery Rules",
    "sources_count": 2,
    "sources": [
      "ps-pps-9.1r10.0-profiler-administration-guide.pdf",
      "PP-Functional Specification for Profiler IPv6 support-041225-084026.pdf"
    ],
    "rag_results_count": 10
  },
  "output_files": {
    "json": "C:\\Users\\SaiShravan.V\\OneDrive - Ivanti\\Desktop\\POC\\data\\test_cases\\test_cases_20260120_104440.json",
    "markdown": "C:\\Users\\SaiShravan.V\\OneDrive - Ivanti\\Desktop\\POC\\data\\test_cases\\test_cases_20260120_104440.md",
    "excel": "C:\\Users\\SaiShravan.V\\OneDrive - Ivanti\\Desktop\\POC\\data\\test_cases\\test_cases_20260120_104440.xlsx"
  },
  "script_status": "not_generated",
  "script_file": null,
  "script_files": {},
  "error": null
}