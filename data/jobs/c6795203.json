{
  "job_id": "c6795203",
  "user_prompt": "L2 dot1x authentication using Native Supplicant",
  "model": "gpt-4.1-nano",
  "parameters": {
    "output_formats": [
      "json",
      "markdown",
      "excel"
    ],
    "use_iteration": true
  },
  "target_config": {
    "url": "https://10.34.50.201/dana-na/auth/url_admin/welcome.cgi",
    "username": "shravan",
    "password": "saishravasdcscn",
    "browser": "chromium",
    "environment": "dev"
  },
  "status": "completed",
  "created_at": "2026-01-19T12:58:18.741655",
  "updated_at": "2026-01-19T12:59:39.183316",
  "test_cases": ": COMPREHENSIVE TEST CASES\n\n#### TC_001\n**Test Title:** Successful L2 802.1X authentication using Windows Native Supplicant with valid credentials\n**Category:** positive  \n**Priority:** Critical  \n**Description:** Verify that a Windows endpoint using the built‑in (native) 802.1X supplicant can successfully complete L2 authentication against the PPS/PCS RADIUS server and obtain network access when valid credentials and configuration are provided.\n**Prerequisites:**\n- PPS/PCS configured as RADIUS server for 802.1X on access switch.\n- Switchport `Gi1/0/10` configured for 802.1X (dot1x port‑control auto).\n- Active directory user `corp\\alice.lee` with password `Str0ngP@ss!` and assigned to a role with allowed access.\n- Windows 10 laptop `WIN10-ALICE` connected to `Gi1/0/10`.\n- Windows native 802.1X supplicant configured for:\n  - EAP type: PEAP (EAP‑MSCHAPv2)\n  - Authentication mode: User authentication\n  - Validate server certificate: enabled, trusted PPS/PCS CA installed.\n**Test Data:**\n- Username: `corp\\alice.lee`\n- Password: `Str0ngP@ss!`\n- SSID/VLAN: `CORP-LAN` (wired 802.1X on access VLAN 20)\n**Test Steps:**\n  1. On `WIN10-ALICE`, ensure the Ethernet adapter is enabled and 802.1X is enabled on the adapter’s authentication tab.\n  2. Configure the network profile to use PEAP with EAP‑MSCHAPv2, “Remember my credentials” enabled.\n  3. Disconnect and reconnect the Ethernet cable to trigger 802.1X authentication on `Gi1/0/10`.\n  4. When prompted by the native supplicant, enter username `corp\\alice.lee` and password `Str0ngP@ss!` and click OK.\n  5. Observe the Windows network status icon and adapter details.\n  6. On PPS/PCS, open RADIUS / 802.1X logs and monitor the authentication attempt.\n  7. On the access switch, run `show dot1x interface gi1/0/10` to verify authentication state.\n**Expected Results:**\n- Windows shows the Ethernet network as “Connected” without limited connectivity warnings.\n- `ipconfig` on `WIN10-ALICE` shows a valid IP address in VLAN 20 (e.g., `10.20.10.x`) with correct gateway.\n- PPS/PCS RADIUS logs show a successful authentication event for `corp\\alice.lee`, mapped to the expected realm/role.\n- Switch `show dot1x` output shows `Gi1/0/10` in `authorized` state with session details matching the endpoint MAC.\n- User can reach permitted internal resources (e.g., ping `10.20.10.1` gateway).\n**Postconditions:**\n- 802.1X session established for `WIN10-ALICE`; port remains authorized while link is up.\n- Successful authentication recorded in PPS/PCS and switch logs.\n\n---\n\n#### TC_002\n**Test Title:** Successful L2 802.1X authentication using machine credentials (computer account) via Native Supplicant\n**Category:** positive  \n**Priority:** High  \n**Description:** Validate that Windows native supplicant can authenticate using machine (computer) credentials before user logon, establishing L2 connectivity for domain operations (e.g., GPO, login scripts).\n**Prerequisites:**\n- Domain‑joined machine `WIN10-MACH1$` in AD.\n- PPS/PCS RADIUS policy configured to accept machine auth (host/ or machine certificate).\n- Switchport `Gi1/0/11` configured for 802.1X.\n- Machine certificate installed on `WIN10-MACH1` from domain CA (if using EAP‑TLS).\n**Test Data:**\n- Machine account: `CORP\\WIN10-MACH1$`\n- EAP type: EAP‑TLS (machine certificate) OR PEAP with machine auth (as per deployment).\n**Test Steps:**\n  1. Configure Windows Ethernet adapter on `WIN10-MACH1` for 802.1X using:\n     - EAP‑TLS with “Computer authentication” or\n     - PEAP with “Computer only” authentication (per design).\n  2. Ensure no user is logged in; leave at Windows logon screen.\n  3. Reboot `WIN10-MACH1` to force a fresh 802.1X cycle at startup.\n  4. During boot, monitor switch `show dot1x interface gi1/0/11` for authentication state.\n  5. On PPS/PCS, open RADIUS logs and verify that an 802.1X request is received with machine identity.\n  6. Once booted to logon screen, press `Ctrl+Alt+Del` and confirm domain logon is available (not “log on using cached credentials only”).\n**Expected Results:**\n- Switch shows `Gi1/0/11` in authorized state with identity `host/WIN10-MACH1.corp.local` or equivalent.\n- PPS/PCS logs show successful 802.1X authentication for machine account `WIN10-MACH1$` using appropriate realm/policy.\n- The machine receives a valid IP address from the corporate VLAN before user logon.\n- Domain logon is possible; GPOs and scripts can run at startup.\n**Postconditions:**\n- Active machine‑authenticated 802.1X session on `WIN10-MACH1`.\n- Log entries exist for machine authentication in PPS/PCS.\n\n---\n\n#### TC_003\n**Test Title:** Successful transition from L2 802.1X authentication to Host Checker‑gated L3 VPN connection\n**Category:** positive | integration  \n**Priority:** High  \n**Description:** Verify that once L2 802.1X is successfully established via native supplicant, the user can initiate a Pulse Secure L3 VPN connection where Host Checker is evaluated, including ESAP V4 operation as per documentation.\n**Prerequisites:**\n- TC_001 completed successfully for user `corp\\alice.lee`.\n- Pulse Client installed on `WIN10-ALICE`.\n- PPS/PCS configured for L3 VPN with Host Checker policies and ESAP V4 active (per Host Checker Configuration Guide).\n**Test Data:**\n- User: `corp\\alice.lee / Str0ngP@ss!`\n- VPN server: `vpn.corp.local`\n- ESAP version: 3.2.2 (example from context 10) or admin‑configured active version.\n**Test Steps:**\n  1. Confirm `WIN10-ALICE` is already 802.1X‑authenticated on L2 (check port state on switch).\n  2. Launch Pulse Client on `WIN10-ALICE`.\n  3. Connect to `vpn.corp.local` using the same user credentials.\n  4. Observe Host Checker initiation and ESAP SDK download/usage (per logs or client messages).\n  5. On PPS/PCS, monitor user session logs and Host Checker logs.\n  6. Verify that L3 VPN tunnel is established following successful posture check.\n**Expected Results:**\n- Pulse Client shows Host Checker starting, downloading or using ESAP V4 successfully (no upgrade failure).\n- Host Checker evaluates OPSWAT rules and reports compliance.\n- PPS/PCS logs show Host Checker evaluation success, followed by L3 tunnel established for `corp\\alice.lee`.\n- User gains expected VPN access role and can access protected internal resources.\n**Postconditions:**\n- Active L2 802.1X session plus L3 VPN session with Host Checker compliant state.\n- ESAP V4 SDK remains installed on client for subsequent host checks (per context 2–3).\n\n---\n\n#### TC_004\n**Test Title:** 802.1X authentication failure with invalid password via Native Supplicant\n**Category:** negative  \n**Priority:** Critical  \n**Description:** Ensure that an 802.1X authentication attempt with an incorrect password is rejected and L2 access is not granted.\n**Prerequisites:**\n- Same environment as TC_001.\n**Test Data:**\n- Username: `corp\\alice.lee`\n- Invalid Password: `WrongP@ss123`\n**Test Steps:**\n  1. On `WIN10-ALICE`, disconnect Ethernet cable; wait 10 seconds.\n  2. Reconnect Ethernet cable to `Gi1/0/10`.\n  3. When native supplicant prompts, enter `corp\\alice.lee / WrongP@ss123`.\n  4. Observe the connection status on Windows (network icon, adapter status).\n  5. On PPS/PCS, monitor RADIUS logs for this attempt.\n  6. On the switch, run `show dot1x interface gi1/0/10` after 30–60 seconds.\n  7. Attempt to ping default gateway `10.20.10.1` from the client.\n**Expected Results:**\n- PPS/PCS RADIUS logs show authentication failure due to incorrect credentials.\n- Switch keeps `Gi1/0/10` in `unauthorized` state; no data VLAN assigned (may be in guest or restricted VLAN if configured).\n- Windows shows “Authentication failed” or similar error; Ethernet either shows no connectivity or “Limited connectivity” depending on fallback policy.\n- Client cannot obtain a corporate IP address or reach corporate resources.\n**Postconditions:**\n- No active 802.1X session for `WIN10-ALICE` with those credentials.\n- Failure recorded in logs; account remains not locked unless lockout policy triggers.\n\n---\n\n#### TC_005\n**Test Title:** 802.1X authentication attempt with unknown user via Native Supplicant\n**Category:** negative  \n**Priority:** High  \n**Description:** Validate that an 802.1X attempt with a non‑existent user is rejected and that logging and error messages are appropriate.\n**Prerequisites:**\n- Same switching and RADIUS configuration as TC_001.\n**Test Data:**\n- Username: `corp\\ghost.user`\n- Password: `SomeP@ssw0rd`\n**Test Steps:**\n  1. On a test laptop `WIN10-TEST1`, configure the native supplicant as per TC_001.\n  2. Connect Ethernet to `Gi1/0/12`.\n  3. When prompted, enter `corp\\ghost.user / SomeP@ssw0rd`.\n  4. Observe Windows connection status and any error notifications.\n  5. On PPS/PCS, monitor RADIUS logs for user `corp\\ghost.user`.\n  6. Check switch `show dot1x interface gi1/0/12`.\n**Expected Results:**\n- PPS/PCS rejects authentication with “user not found” or equivalent reason.\n- Switch port remains unauthorized or is placed in a configured guest VLAN.\n- Client does not receive access to corporate VLAN or resources.\n- Logs clearly indicate failure due to unknown username (for audit).\n**Postconditions:**\n- No active 802.1X session for `WIN10-TEST1`.\n- No AD user account changes.\n\n---\n\n#### TC_006\n**Test Title:** 802.1X authentication failure due to invalid server certificate (untrusted PPS/PCS CA)\n**Category:** negative | security  \n**Priority:** High  \n**Description:** Ensure that the Windows native supplicant refuses to complete 802.1X authentication when the PPS/PCS RADIUS server certificate is not trusted.\n**Prerequisites:**\n- Test PPS/PCS instance using a self‑signed certificate or CA not in client trust store.\n- 802.1X already configured on switch and PPS/PCS.\n- `WIN10-UNTRUST` machine with “Validate server certificate” enabled in PEAP settings and no trust for the RADIUS certificate.\n**Test Data:**\n- Username: `corp\\alice.lee / Str0ngP@ss!`\n- Server certificate: Untrusted/self‑signed.\n**Test Steps:**\n  1. Connect `WIN10-UNTRUST` to `Gi1/0/13`.\n  2. Ensure 802.1X is enabled for the Ethernet adapter and PEAP is configured with “Validate server certificate”.\n  3. When certificate warning appears, do NOT accept the untrusted certificate if prompted (or disable automatic acceptance).\n  4. Observe whether 802.1X authentication completes.\n  5. Check PPS/PCS logs to confirm whether EAP negotiation reached the credential exchange step.\n  6. Check switch `show dot1x interface gi1/0/13`.\n**Expected Results:**\n- Client either prompts user about untrusted certificate or silently fails, depending on configuration.\n- 802.1X authentication is not completed; no credentials are sent if validation fails.\n- Port remains unauthorized or is placed in restricted/guest VLAN per policy.\n- PPS/PCS logs show incomplete EAP session or client abort, not a successful authentication.\n**Postconditions:**\n- No authorized 802.1X session with untrusted RADIUS certificate.\n- Security is preserved; user is not accidentally connected to a rogue/wrong server.\n\n---\n\n#### TC_007\n**Test Title:** 802.1X authentication behavior when user cancels credential prompt\n**Category:** negative  \n**Priority:** Medium  \n**Description:** Verify that if a user cancels the native supplicant authentication prompt, L2 access is not granted and the system behaves gracefully.\n**Prerequisites:**\n- Same as TC_001.\n**Test Data:**\n- No credentials submitted (user cancels).\n**Test Steps:**\n  1. On `WIN10-ALICE`, disconnect and reconnect Ethernet on `Gi1/0/10`.\n  2. Wait for native supplicant credential prompt.\n  3. Click “Cancel” at the prompt without entering credentials.\n  4. Observe Windows network status and any repeated prompts.\n  5. Monitor PPS/PCS logs for incomplete or aborted 802.1X sessions.\n  6. Check switch to confirm port state.\n**Expected Results:**\n- No credentials are sent to PPS/PCS; RADIUS logs show either no attempt or failed EAP conversation.\n- Port remains unauthorized or goes to fallback VLAN, depending on policy.\n- Windows may re‑prompt after a timeout; until successful authentication, no corporate access is granted.\n**Postconditions:**\n- No authenticated 802.1X session.\n- System correctly logs or tracks aborted authentication attempts.\n\n---\n\n#### TC_008\n**Test Title:** 802.1X port state behavior at link‑up and link‑down boundaries\n**Category:** boundary  \n**Priority:** High  \n**Description:** Verify that 802.1X state transitions correctly when the physical link is established and removed, and that sessions are cleared on link‑down.\n**Prerequisites:**\n- 802.1X configured on `Gi1/0/10` for user `corp\\alice.lee`.\n- Successful 802.1X authentication path verified (TC_001).\n**Test Data:**\n- Same as TC_001.\n**Test Steps:**\n  1. Authenticate `WIN10-ALICE` successfully over 802.1X.\n  2. On the switch, run `show dot1x interface gi1/0/10` and capture session status (authorized).\n  3. Physically disconnect the Ethernet cable.\n  4. Within 5–10 seconds, run `show dot1x interface gi1/0/10` again.\n  5. Reconnect the Ethernet cable and allow the supplicant to re‑authenticate automatically (no user input if credentials cached).\n  6. Check `show dot1x interface gi1/0/10` after reconnection.\n**Expected Results:**\n- After disconnection, port 802.1X state transitions to `unauthorized` or `link-down` and any session state is cleared.\n- After reconnection, supplicant reinitiates 802.1X; PPS/PCS logs a new authentication session.\n- Port returns to `authorized` state with a fresh session ID.\n**Postconditions:**\n- Only the latest session is active; old sessions are removed after link‑down.\n- PPS/PCS session logs show separate authentications before and after cable reconnection.\n\n---\n\n#### TC_009\n**Test Title:** Maximum reauthentication interval boundary for 802.1X (session timeout)\n**Category:** boundary  \n**Priority:** Medium  \n**Description:** Verify behavior when the 802.1X session is configured with a maximum session timeout, ensuring forced reauthentication occurs at the configured interval.\n**Prerequisites:**\n- PPS/PCS RADIUS configuration with Session‑Timeout attribute set to 300 seconds (5 minutes) for test role.\n- Switch configured to honor RADIUS Session‑Timeout.\n- `WIN10-ALICE` successfully authenticating via native supplicant.\n**Test Data:**\n- Session‑Timeout: 300 seconds.\n**Test Steps:**\n  1. Configure RADIUS policy for test user `corp\\session.user` to send Session‑Timeout=300.\n  2. On `WIN10-ALICE`, authenticate over 802.1X as `corp\\session.user`.\n  3. Confirm in switch output that port is authorized.\n  4. Start a timer upon successful authentication.\n  5. Monitor switch logs or debug for reauthentication events.\n  6. After ~5 minutes, verify that the port is forced to reauthenticate (check logs and `show dot1x`).\n  7. Confirm the native supplicant automatically reauthenticates without user intervention if credentials are cached.\n**Expected Results:**\n- RADIUS Access‑Accept contains Session‑Timeout=300.\n- At ~300 seconds, the switch triggers a reauthentication.\n- PPS/PCS logs show a new authentication attempt; if successful, port remains authorized.\n- No prolonged unauthorized state occurs for the client during reauthentication.\n**Postconditions:**\n- Client remains continuously connected with periodic reauthentications enforced by boundary timeout.\n- Logging clearly records each reauthentication event.\n\n---\n\n#### TC_010\n**Test Title:** 802.1X failure when native supplicant is disabled on the network adapter\n**Category:** negative | boundary  \n**Priority:** High  \n**Description:** Confirm that if 802.1X authentication is disabled in the adapter properties, the port remains unauthorized and no 802.1X authentication occurs.\n**Prerequisites:**\n- Switch port `Gi1/0/14` configured for 802.1X with no MAC authentication bypass.\n- `WIN10-NOX` machine connected to `Gi1/0/14`.\n**Test Data:**\n- Ethernet adapter with 802.1X disabled in properties (no authentication).\n**Test Steps:**\n  1. On `WIN10-NOX`, open Ethernet adapter properties > Authentication tab.\n  2. Ensure “Enable IEEE 802.1X authentication for this network” is unchecked.\n  3. Connect the laptop to switchport `Gi1/0/14`.\n  4. Observe Windows network status (likely “Unidentified network” or no network).\n  5. On switch, run `show dot1x interface gi1/0/14`.\n  6. On PPS/PCS, check RADIUS logs for that MAC/IP for the test period.\n**Expected Results:**\n- No 802.1X EAP exchanges are logged on PPS/PCS; no Access‑Request is received.\n- Switch sees no supplicant; `Gi1/0/14` remains in unauthorized state or possibly triggers a guest VLAN or port‑shutdown according to policy.\n- Client does not obtain corporate network access.\n**Postconditions:**\n- No authenticated session is created.\n- Logs show lack of 802.1X activity rather than a credential failure.\n\n---\n\n#### TC_011\n**Test Title:** Integration of 802.1X L2 authentication with Host Checker ESAP V3 to V4 upgrade failure on L2, success on subsequent L3\n**Category:** integration  \n**Priority:** High  \n**Description:** Validate documented behavior when ESAP upgrade from V3 to V4 fails during L2 connection, but Host Checker uses V3 and successfully upgrades and evaluates at L3 connection, as per Host Checker guide (context 2–3).\n**Prerequisites:**\n- Client `WIN10-ESAP` with OPSWAT V3 SDK installed.\n- PPS/PCS configured to upgrade to ESAP V4 and use Host Checker for both L2 and L3 connections.\n- L2 connection configured through Pulse Client using 802.1X or network access where Host Checker is triggered at L2.\n**Test Data:**\n- User: `corp\\esap.user / P@ssw0rd123`\n- ESAP:\n  - Client: ESAP/OPSWAT V3 initially.\n  - Server: Active ESAP V4 (as per context 10).\n**Test Steps:**\n  1. On `WIN10-ESAP`, connect to the network and initiate L2 connection via Pulse Client (or predefined L2 connection type) such that Host Checker is triggered.\n  2. Simulate failure to download ESAP V4 SDK during L2 (e.g., block download via firewall/proxy or disconnect internet to ESAP URL).\n  3. Confirm via PPS/PCS logs that:\n     - Server attempted to send upgrade information.\n     - Client fails to download V4 SDK.\n  4. Verify that Host Checker falls back to V3 SDK and sends security product details using V3.\n  5. Confirm that L2 connection is established and followed by L3 connection attempt (per context).\n  6. For L3 connection, restore download capability and trigger Host Checker again.\n  7. Verify that ESAP V4 SDK is now successfully downloaded and used for posture evaluation.\n**Expected Results:**\n- During L2:\n  - V4 SDK download fails.\n  - Host Checker uses V3 SDK to collect product details.\n  - PPS/PCS evaluates OPSWAT rules based on V3 data.\n  - L2 is established and then L3 connection is attempted; server remembers that ESAP upgrade is needed.\n- During L3:\n  - Host Checker is triggered again.\n  - Client successfully downloads and installs V4 SDK.\n  - PPS/PCS evaluates rules using V4 SDK; connection proceeds if compliant.\n- Behavior matches descriptions in contexts 2–3.\n**Postconditions:**\n- ESAP V4 SDK installed on client for subsequent host checks.\n- L2 and L3 connections successfully established with documented upgrade flow.\n\n---\n\n#### TC_012\n**Test Title:** Security: Preventing unauthorized VLAN access when Host Checker fails at realm level after successful 802.1X\n**Category:** security | integration  \n**Priority:** Critical  \n**Description:** Ensure that even if 802.1X successfully authenticates the device at L2, failure of Host Checker (non‑compliant posture) at the realm authentication policy prevents access to secure resources or moves user to a restricted role.\n**Prerequisites:**\n- 802.1X working for user `corp\\noncompliant.user`.\n- PPS/PCS Host Checker policy implemented at realm level requiring specific antivirus or firewall (per Host Checker Configuration Guide).\n- Test machine `WIN10-NC` intentionally non‑compliant (e.g., disabled AV).\n**Test Data:**\n- Username: `corp\\noncompliant.user / N0tComply!`\n- Host Checker policy: require antivirus up to date; remediation option defined (context 4).\n**Test Steps:**\n  1. Authenticate `WIN10-NC` at L2 via native supplicant 802.1X to PPS/PCS.\n  2. From the L2‑authenticated state, attempt to sign in to PPS/PCS realm or start L3 VPN that has Host Checker enforced.\n  3. Verify that Host Checker runs and detects missing or outdated security product.\n  4. Observe resulting user access: assigned role, realm access, and any remediation page/notification.\n  5. Try to access a protected internal resource requiring compliant role.\n**Expected Results:**\n- 802.1X L2 authentication succeeds; port is authorized and IP assigned.\n- Host Checker evaluation fails due to non‑compliance.\n- PPS/PCS either:\n  - denies access to the secure realm/L3 VPN, showing remediation page, or\n  - assigns user to a restricted role with limited/isolated access as configured.\n- User cannot reach high‑security resources until posture is compliant, despite 802.1X success.\n**Postconditions:**\n- Host Checker failure logged.\n- User remains either blocked or constrained by restricted role; normal secure resources not accessible.\n\n---\n\n#### TC_013\n**Test Title:** Security: 802.1X authentication attempts with malformed EAP packets\n**Category:** security | negative  \n**Priority:** High  \n**Description:** Confirm that PPS/PCS and the switch safely handle malformed or corrupted EAP frames during 802.1X and do not crash, hang, or grant access.\n**Prerequisites:**\n- Test port `Gi1/0/15` configured for 802.1X.\n- Traffic generation tool (e.g., Scapy or similar) on a Linux box connected to `Gi1/0/15` capable of crafting malformed EAPOL/EAP packets.\n**Test Data:**\n- Malformed 802.1X packets: invalid EAP length, unsupported EAP type, truncated payloads.\n**Test Steps:**\n  1. Connect Linux test host to `Gi1/0/15`.\n  2. Ensure no normal 802.1X supplicant is running on the interface.\n  3. Use packet generator to send EAPOL‑Start followed by malformed EAP frames toward the switch.\n  4. Monitor PPS/PCS RADIUS logs and switch logs for any errors.\n  5. Verify that port `Gi1/0/15` remains unauthorized throughout the test.\n  6. Check PPS/PCS and switch CPU/memory to ensure no resource exhaustion or crash.\n**Expected Results:**\n- PPS/PCS ignores malformed EAP or logs them as failed/invalid; no Access‑Accept is returned.\n- Switch port remains unauthorized; no VLAN access is granted.\n- No crash, watchdog reset, or high CPU occurs on PPS/PCS or switch.\n**Postconditions:**\n- System remains stable and secure.\n- No unexpected sessions created.\n\n---\n\n#### TC_014\n**Test Title:** Performance: 802.1X authentication under high concurrent client load using Native Supplicants\n**Category:** performance  \n**Priority:** High  \n**Description:** Measure PPS/PCS and switch performance when a large number of clients simultaneously perform L2 802.1X authentication using native supplicants.\n**Prerequisites:**\n- Test lab with at least 200–500 Windows endpoints or virtual clients, or a load generator capable of simulating many 802.1X sessions.\n- 802.1X configured on multiple switch access ports.\n- PPS/PCS sized appropriately with monitoring tools enabled.\n**Test Data:**\n- Number of clients: start with 200, scale to 500 or as design requires.\n- Authentication method: PEAP (EAP‑MSCHAPv2).\n**Test Steps:**\n  1. Prepare test clients with identical 802.1X profiles and valid AD credentials.\n  2. Power off or disconnect all client links.\n  3. Simultaneously power on or connect all endpoints to trigger concurrent 802.1X authentication.\n  4. Measure:\n     - Time for 95% of clients to successfully authenticate.\n     - PPS/PCS CPU, memory, and RADIUS response times.\n     - Switch CPU and interface statistics.\n  5. Check for any authentication failures, timeouts, or delayed responses.\n  6. Repeat at higher client counts (if possible) to identify saturation point.\n**Expected Results:**\n- The majority of clients (e.g., ≥95%) successfully authenticate within agreed SLA (e.g., 30–60 seconds).\n- PPS/PCS remains responsive; CPU and memory within acceptable thresholds; no crashes or restarts.\n- Switch handles EAPOL traffic without significant performance degradation.\n- RADIUS logs show successful authentication entries without excessive timeouts.\n**Postconditions:**\n- System’s capacity characteristics under load are documented.\n- Any bottlenecks or limits identified for capacity planning.\n\n---\n\n#### TC_015\n**Test Title:** Performance: 802.1X reauthentication storm (frequent reauth) impact on PPS/PCS\n**Category:** performance  \n**Priority:** Medium  \n**Description:** Evaluate PPS/PCS behavior when many ports are configured with very low 802.1X reauthentication intervals, causing a frequent reauth “storm.”\n**Prerequisites:**\n- 50–100 test clients connected and authenticated via 802.1X.\n- Switch configured for forced reauthentication interval of 60 seconds on test ports.\n**Test Data:**\n- Reauth interval: 60 seconds.\n**Test Steps:**\n  1. Configure dot1x reauth on access ports to 60 seconds (or vendor equivalent).\n  2. Allow all test clients to initially authenticate successfully.\n  3. Start monitoring PPS/PCS performance metrics and RADIUS logs.\n  4. Observe system behavior over at least 15–30 minutes (multiple reauth cycles).\n  5. Track any authentication failures, delays, or increased latency.\n**Expected Results:**\n- PPS/PCS handles frequent reauth without significant performance degradation.\n- RADIUS logs show periodic successful reauth entries per client.\n- No service crashes, watchdog resets, or unrecoverable errors.\n- Clients remain connected without noticeable network disruption.\n**Postconditions:**\n- Performance impact of aggressive reauth policy is known.\n- Recommendations can be made for minimum safe reauth interval.\n\n---\n\n#### TC_016\n**Test Title:** Boundary: Minimum credential length and special characters in 802.1X username/password\n**Category:** boundary | negative  \n**Priority:** Medium  \n**Description:** Verify 802.1X behavior with minimum and complex credentials, including boundary values for username and password length and special characters.\n**Prerequisites:**\n- AD accounts created with boundary credentials.\n- 802.1X configured for PEAP (EAP‑MSCHAPv2).\n**Test Data:**\n- User1 (minimum length): `corp\\a` / password: `Ab1!` (4 chars)\n- User2 (max length username): `corp\\` + 20–30 char username `verylongusername123` (as allowed by policy).\n- User3 (special chars): `corp\\spec.user` / password: `P@ssw0rd!#$%^&*()_+`\n**Test Steps:**\n  1. Configure `WIN10-BOUND` native supplicant to use PEAP.\n  2. Perform 802.1X authentication for each user in turn:\n     - Disconnect/reconnect cable.\n     - When prompted, enter each set of credentials exactly as defined.\n  3. Monitor PPS/PCS logs for each attempt.\n  4. Verify whether authentication passes based on AD and RADIUS policy (assuming these credentials are valid in AD).\n**Expected Results:**\n- If AD allows these credential forms, PPS/PCS authenticates them successfully.\n- No input truncation or corruption occurs; logs display full usernames.\n- Special characters are handled correctly; no injection or parsing errors occur.\n**Postconditions:**\n- Verified that the system correctly handles boundary credential values.\n- No unexpected errors or security issues introduced.\n\n---\n\n#### TC_017\n**Test Title:** Integration: 802.1X with fallback to guest VLAN when Host Checker is not installed (agentless vs. agent‑based)\n**Category:** integration | negative  \n**Priority:** Medium  \n**Description:** Validate that when Host Checker (agent) is required but not present, user is placed in a guest VLAN or restricted access according to realm/role configuration.\n**Prerequisites:**\n- PPS/PCS Host Checker policy implemented requiring agent/ActiveX installation (per Host Checker guide).\n- Port `Gi1/0/16` configured for 802.1X with RADIUS attributes assigning VLAN based on RADIUS role.\n- `WIN10-GUEST` with 802.1X configured but no Host Checker client installed.\n**Test Data:**\n- User: `corp\\guest.user / GuestP@ss1`\n- RADIUS/role mapping:\n  - If Host Checker passes: VLAN 20 (CORP).\n  - If Host Checker missing/fails: VLAN 30 (GUEST).\n**Test Steps:**\n  1. On `WIN10-GUEST`, ensure Pulse Host Checker is not installed.\n  2. Connect to `Gi1/0/16` and authenticate via 802.1X using `guest.user`.\n  3. PPS/PCS prompts for Host Checker installation or runs agentless check as configured.\n  4. Decline or prevent Host Checker installation.\n  5. Monitor RADIUS logs to see which role/VLAN is returned.\n  6. On switch, confirm `Gi1/0/16` is assigned to VLAN 30.\n  7. Attempt to access internal high‑security resources; also test internet or remediation portal per policy.\n**Expected Results:**\n- 802.1X authentication may succeed at identity level but Host Checker fails or is not present.\n- PPS/PCS assigns a restricted role/GUEST VLAN via RADIUS attributes.\n- Switch places port in VLAN 30; client cannot access protected internal resources.\n- Remediation options (e.g., instructions to install Host Checker) are presented if configured.\n**Postconditions:**\n- Guest or restricted network assignment confirmed when Host Checker missing.\n- Host Checker enforcement integrated correctly with 802.1X‑driven VLAN assignment.\n\n---\n\n#### TC_018\n**Test Title:** Security: Verify that “Exclude Native ESAP packages on the end user” has no impact on L2 802.1X authentication\n**Category:** security | integration  \n**Priority:** Low  \n**Description:** Confirm that enabling the configuration option “Exclude Native ESAP packages on the end user” (context 10) only affects Host Checker components and does not break or alter L2 802.1X authentication using native supplicant.\n**Prerequisites:**\n- PPS/PCS admin console accessible.\n- 802.1X working for test user `corp\\esap.exclude`.\n- Host Checker configured but not required for pure L2 802.1X.\n**Test Data:**\n- Option: “Exclude Native ESAP packages on the end user” checked (per context 10).\n**Test Steps:**\n  1. In PPS/PCS admin console, navigate to `Authentication > Endpoint Security > Host Checker`.\n  2. Under ESAP settings, enable the checkbox “Exclude Native ESAP packages on the end user” and click “Save Changes” and “Activate” as needed.\n  3. On `WIN10-ALICE`, perform L2 802.1X authentication via native supplicant using user `corp\\esap.exclude`.\n  4. Observe whether any Host Checker or ESAP installation prompts appear.\n  5. Confirm authentication result and port authorization on the switch.\n**Expected Results:**\n- 802.1X authentication proceeds normally; port becomes authorized.\n- No requirement to install ESAP packages on the client for L2 802.1X.\n- Configuration option only affects Host Checker agent packages and does not interfere with native supplicant behavior.\n**Postconditions:**\n- L2 802.1X remains functional with the option enabled.\n- ESAP deployment behavior changed only for Host Checker, not for 802.1X.\n\n---\n\n#### TC_019\n**Test Title:** Negative: 802.1X authentication with expired user account\n**Category:** negative  \n**Priority:** Medium  \n**Description:** Ensure that user accounts that are expired in the identity store are denied 802.1X L2 access.\n**Prerequisites:**\n- AD user `corp\\expired.user` configured with expired account or disabled login.\n- 802.1X configured for PEAP/MSCHAPv2 against AD.\n**Test Data:**\n- Username: `corp\\expired.user`\n- Password: `ExpiredP@ss1` (known correct password).\n**Test Steps:**\n  1. On test machine `WIN10-EXP`, configure 802.1X for `corp\\expired.user`.\n  2. Connect to 802.1X‑enabled port.\n  3. Provide credentials when prompted.\n  4. Monitor PPS/PCS RADIUS logs and AD logs.\n  5. Check port state with `show dot1x` on the switch.\n**Expected Results:**\n- PPS/PCS/AD denies authentication with reason related to account expiration.\n- Switch port remains unauthorized or moved to fallback VLAN as configured.\n- No corporate VLAN access is granted.\n**Postconditions:**\n- No active 802.1X session associated with expired account.\n- Denial is properly logged for auditing.\n\n---\n\n#### TC_020\n**Test Title:** Boundary/Negative: 802.1X authentication with null/empty username & password from native supplicant\n**Category:** boundary | negative  \n**Priority:** Medium  \n**Description:** Verify behavior when the native supplicant attempts 802.1X authentication but credentials are empty or null (e.g., misconfigured profile).\n**Prerequisites:**\n- `WIN10-EMPTY` machine with misconfigured 802.1X profile (blank username/password).\n- 802.1X configured on switch and PPS/PCS.\n**Test Data:**\n- Username: `\"\"` (empty)\n- Password: `\"\"` (empty)\n**Test Steps:**\n  1. On `WIN10-EMPTY`, open 802.1X settings and configure PEAP/MSCHAPv2 with “Use a different user name for connection” but leave username and password fields blank (if UI allows).\n  2. Connect to 802.1X‑enabled switchport `Gi1/0/17`.\n  3. Observe whether the supplicant sends an Access‑Request, and what username appears in logs.\n  4. Check PPS/PCS RADIUS logs for this attempt.\n  5. Check switch `show dot1x` output.\n**Expected Results:**\n- Authentication fails; PPS/PCS logs indicate missing or invalid credentials.\n- No Access‑Accept is returned; port remains unauthorized or goes to fallback VLAN.\n- Null/empty credentials are not treated as anonymous access or mapped to any allow‑all policy.\n**Postconditions:**\n- No unauthorized access with missing credential data.\n- Proper sanitization and rejection of empty username/password.\n\n---\n\n###",
  "test_plan": ": TEST PLANNING ANALYSIS\n\n1. **Feature Overview**  \n   The tests cover Layer 2 (L2) 802.1X (dot1x) authentication using the OS native supplicant (primarily Windows), integrated with Pulse Secure PPS/PCS as RADIUS/Policy server. They also validate interactions with Host Checker/ESAP posture assessment and resulting VLAN/role assignments.\n\n2. **Test Objectives**\n   - Validate successful 802.1X authentication for user and machine identities using native supplicants.\n   - Ensure proper failure handling for bad credentials, unknown users, untrusted certificates, disabled supplicant, expired accounts, and malformed EAP packets.\n   - Confirm correct boundary behavior for link state changes, session timeouts, and credential formats.\n   - Verify integration with Host Checker, ESAP V3→V4 upgrade flow, and realm/role/VLAN policies (including guest/restricted access).\n   - Confirm security robustness (no unauthorized access, correct certificate handling, safe handling of malformed packets).\n   - Assess performance under concurrent authentication load and frequent reauth conditions.\n\n3. **Coverage Analysis**\n   - Positive: TC_001, TC_002, TC_003 (partly), TC_011 (partly) → 3–4 tests\n   - Negative: TC_004, TC_005, TC_006, TC_007, TC_010, TC_012 (posture fail aspect), TC_013, TC_017 (agent missing aspect), TC_019, TC_020 → ~9–10 tests\n   - Boundary: TC_008, TC_009, TC_010 (state boundary), TC_016, TC_020 → 4–5 tests\n   - Integration: TC_003, TC_011, TC_012, TC_017, TC_018 → 5 tests\n   - Security-focused: TC_006, TC_012, TC_013, TC_016 (special chars), TC_018 → 4–5 tests\n   - Performance: TC_014, TC_015 → 2 tests  \n\n   Categories overlap by design (e.g., some tests are both integration and security), giving broad functional, negative, and non‑functional coverage around L2 802.1X with native supplicants.\n\n4. **Risk Areas / High‑Priority Focus**\n   - **Security risks:** Incorrect certificate handling (rogue RADIUS server), improper handling of malformed EAP, and potential unauthorized access due to fallback behavior or Host Checker misconfiguration.\n   - **Integration with Host Checker/ESAP:** ESAP V3→V4 upgrade behavior across L2/L3 (documented flows) and accurate VLAN/role assignment when posture fails or agent is missing.\n   - **Scalability and performance:** High concurrent 802.1X logons and frequent reauthentication impact on PPS/PCS and switching infrastructure.\n   - **Operational stability:** Correct session cleanup on link‑down, session timeout boundaries, and resilience against misconfigured supplicants (disabled 802.1X, empty credentials, expired accounts).\n\nFurther expansion can add OS variability (macOS, Linux native supplicants), additional EAP types (EAP‑TLS vs PEAP), and more detailed negative tests around RADIUS attribute handling and logging/auditing.",
  "validation_report": null,
  "metadata": {
    "user_prompt": "L2 dot1x authentication using Native Supplicant",
    "intent": "feature description",
    "feature_name": "L2 dot1x authentication using Native Supplicant",
    "sources_count": 3,
    "sources": [
      "ps-pps-9.1r10.0-profiler-administration-guide.pdf",
      "ps-pcs-host-checker-config-guide.pdf",
      "PP-CAV Design-041225-082934.pdf"
    ],
    "rag_results_count": 10
  },
  "output_files": {
    "json": "C:\\Users\\SaiShravan.V\\OneDrive - Ivanti\\Desktop\\POC\\data\\test_cases\\test_cases_20260119_125939.json",
    "markdown": "C:\\Users\\SaiShravan.V\\OneDrive - Ivanti\\Desktop\\POC\\data\\test_cases\\test_cases_20260119_125939.md",
    "excel": "C:\\Users\\SaiShravan.V\\OneDrive - Ivanti\\Desktop\\POC\\data\\test_cases\\test_cases_20260119_125939.xlsx"
  },
  "script_status": "not_generated",
  "script_file": null,
  "script_files": {},
  "error": null
}